<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Giftless - the GIT LFS server | Datopian Tech</title>
    <meta name="generator" content="VuePress 1.7.0">
    
    <meta name="description" content="An overview of our technology">
    
    <link rel="preload" href="/assets/css/0.styles.d75de8d6.css" as="style"><link rel="preload" href="/assets/js/app.cae7a747.js" as="script"><link rel="preload" href="/assets/js/3.fa4bc789.js" as="script"><link rel="preload" href="/assets/js/61.d50d013c.js" as="script"><link rel="prefetch" href="/assets/js/10.97cdf956.js"><link rel="prefetch" href="/assets/js/11.17e0f31f.js"><link rel="prefetch" href="/assets/js/12.903532db.js"><link rel="prefetch" href="/assets/js/13.6eb9e3f2.js"><link rel="prefetch" href="/assets/js/14.321278ec.js"><link rel="prefetch" href="/assets/js/15.b1bb191a.js"><link rel="prefetch" href="/assets/js/16.b3caaad1.js"><link rel="prefetch" href="/assets/js/17.b381cf63.js"><link rel="prefetch" href="/assets/js/18.3ebc898b.js"><link rel="prefetch" href="/assets/js/19.69d5ac20.js"><link rel="prefetch" href="/assets/js/20.7083d06c.js"><link rel="prefetch" href="/assets/js/21.49fa9fe8.js"><link rel="prefetch" href="/assets/js/22.154f4b66.js"><link rel="prefetch" href="/assets/js/23.4dc144f6.js"><link rel="prefetch" href="/assets/js/24.cc815849.js"><link rel="prefetch" href="/assets/js/25.ce5ada67.js"><link rel="prefetch" href="/assets/js/26.7e80a33f.js"><link rel="prefetch" href="/assets/js/27.1f061470.js"><link rel="prefetch" href="/assets/js/28.e3d21bf6.js"><link rel="prefetch" href="/assets/js/29.e9308e5a.js"><link rel="prefetch" href="/assets/js/30.e8f78de6.js"><link rel="prefetch" href="/assets/js/31.8fbfd92e.js"><link rel="prefetch" href="/assets/js/32.5f629eb0.js"><link rel="prefetch" href="/assets/js/33.ec83f018.js"><link rel="prefetch" href="/assets/js/34.d32a8ecf.js"><link rel="prefetch" href="/assets/js/35.429d828a.js"><link rel="prefetch" href="/assets/js/36.738af169.js"><link rel="prefetch" href="/assets/js/37.f10f1292.js"><link rel="prefetch" href="/assets/js/38.ab6a3f07.js"><link rel="prefetch" href="/assets/js/39.21f0a5a9.js"><link rel="prefetch" href="/assets/js/4.87a98c1d.js"><link rel="prefetch" href="/assets/js/40.dba88d93.js"><link rel="prefetch" href="/assets/js/41.5659ab21.js"><link rel="prefetch" href="/assets/js/42.24077f70.js"><link rel="prefetch" href="/assets/js/43.735df8f3.js"><link rel="prefetch" href="/assets/js/44.d7f00d32.js"><link rel="prefetch" href="/assets/js/45.01aa22e7.js"><link rel="prefetch" href="/assets/js/46.95143001.js"><link rel="prefetch" href="/assets/js/47.af314171.js"><link rel="prefetch" href="/assets/js/48.1c268429.js"><link rel="prefetch" href="/assets/js/49.302b500d.js"><link rel="prefetch" href="/assets/js/5.45c6c688.js"><link rel="prefetch" href="/assets/js/50.9129941e.js"><link rel="prefetch" href="/assets/js/51.b269d2ad.js"><link rel="prefetch" href="/assets/js/52.851ebdfd.js"><link rel="prefetch" href="/assets/js/53.9e7ccefa.js"><link rel="prefetch" href="/assets/js/54.caca56c2.js"><link rel="prefetch" href="/assets/js/55.1f1ab33c.js"><link rel="prefetch" href="/assets/js/56.c1422b04.js"><link rel="prefetch" href="/assets/js/57.464e123f.js"><link rel="prefetch" href="/assets/js/58.03e19fda.js"><link rel="prefetch" href="/assets/js/59.a333bcd5.js"><link rel="prefetch" href="/assets/js/6.cfacb13f.js"><link rel="prefetch" href="/assets/js/60.9041a8a8.js"><link rel="prefetch" href="/assets/js/62.c39ab5cf.js"><link rel="prefetch" href="/assets/js/63.b15fc128.js"><link rel="prefetch" href="/assets/js/64.3d09cd94.js"><link rel="prefetch" href="/assets/js/65.75da2c7c.js"><link rel="prefetch" href="/assets/js/66.ca9f6de5.js"><link rel="prefetch" href="/assets/js/67.64429417.js"><link rel="prefetch" href="/assets/js/68.73fc875e.js"><link rel="prefetch" href="/assets/js/69.0952d878.js"><link rel="prefetch" href="/assets/js/7.01499fc1.js"><link rel="prefetch" href="/assets/js/70.2cbd4cd8.js"><link rel="prefetch" href="/assets/js/71.5783e588.js"><link rel="prefetch" href="/assets/js/72.8b7b1a39.js"><link rel="prefetch" href="/assets/js/73.e9de330f.js"><link rel="prefetch" href="/assets/js/74.ad9f0422.js"><link rel="prefetch" href="/assets/js/75.41486c77.js"><link rel="prefetch" href="/assets/js/76.2b23eb01.js"><link rel="prefetch" href="/assets/js/77.5d087cf7.js"><link rel="prefetch" href="/assets/js/78.67f553cc.js"><link rel="prefetch" href="/assets/js/79.cd27b859.js"><link rel="prefetch" href="/assets/js/8.822440c2.js"><link rel="prefetch" href="/assets/js/80.4f76d115.js"><link rel="prefetch" href="/assets/js/81.5af672d1.js"><link rel="prefetch" href="/assets/js/82.44ce9c24.js"><link rel="prefetch" href="/assets/js/83.a128929c.js"><link rel="prefetch" href="/assets/js/84.90de6dfd.js"><link rel="prefetch" href="/assets/js/9.63d821ea.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.62a8c583.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d75de8d6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Datopian Tech</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Features" class="dropdown-title"><span class="title">Features</span> <span class="arrow down"></span></button> <button type="button" aria-label="Features" class="mobile-dropdown-title"><span class="title">Features</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/views/" class="nav-link">
  Views
</a></li></ul></div></div> <a href="https://github.com/datopian/tech.datopian.com" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Features" class="dropdown-title"><span class="title">Features</span> <span class="arrow down"></span></button> <button type="button" aria-label="Features" class="mobile-dropdown-title"><span class="title">Features</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/views/" class="nav-link">
  Views
</a></li></ul></div></div> <a href="https://github.com/datopian/tech.datopian.com" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Giftless - the GIT LFS server</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/giftless/#introduction" class="sidebar-link">Introduction</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/giftless/#giftless-api" class="sidebar-link">Giftless API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/giftless/#post-foo-bar-objects-batch" class="sidebar-link">POST /foo/bar/objects/batch</a></li><li class="sidebar-sub-header"><a href="/giftless/#optional-api-endpoints" class="sidebar-link">Optional API endpoints</a></li><li class="sidebar-sub-header"><a href="/giftless/#comment-why-the-slightly-weird-api-layout" class="sidebar-link">Comment: why the slightly weird API layout</a></li></ul></li><li><a href="/giftless/#mapping-from-giftless-to-storage" class="sidebar-link">Mapping from Giftless to Storage</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/giftless/#authentication-and-authorization" class="sidebar-link">Authentication and Authorization</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/giftless/#use-with-git" class="sidebar-link">Use with git</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/giftless/#appendix-summary-of-git-lfs" class="sidebar-link">Appendix: Summary of Git LFS</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/giftless/#summary-of-interaction-for-git-client" class="sidebar-link">Summary of interaction (for git client)</a></li><li class="sidebar-sub-header"><a href="/giftless/#how-git-lfs-works-for-git-locally" class="sidebar-link">How git lfs works for git locally</a></li><li class="sidebar-sub-header"><a href="/giftless/#git-lfs-server-api" class="sidebar-link">Git LFS Server API</a></li><li class="sidebar-sub-header"><a href="/giftless/#batch-api" class="sidebar-link">Batch API</a></li></ul></li><li><a href="/giftless/#appendix-existing-git-lfs-server-implementations" class="sidebar-link">Appendix: Existing Git LFS server implementations</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="giftless-the-git-lfs-server"><a href="#giftless-the-git-lfs-server" class="header-anchor">#</a> Giftless - the GIT LFS server</h1> <h2 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h2> <p>Our work on Giftless started from the context of two distinct needs:</p> <ul><li>Need: direct to (cloud) storage uploading (and download) including from client =&gt; you need a service that will issue tokens to upload direct to storage – what we term a “Storage Access Gateway” =&gt;The Git LFS server protocol actually provides this with its <code>batch</code> API. Rather than reinventing the wheel let’s use this existing protocol.</li> <li>Need: git is already widespread and heavily used by data scientists and data engineers. However, git does not support large files well whilst data work often involves large files. Git LFS is the protocol designed to support large file storage stored outside of git blobstore. If we have our own git lfs server then we can integrate any storage we want with git.</li></ul> <p>From these we arrived at a vision for a standalone Git LFS server (standalone in contrast to the existing git lfs servers provided as an integrated part of existing git hosting providers such as github or gitlab). We also wanted to be able to customize it so it could be backed onto any major cloud storage backend (e.g. S3, GCS, Azure etc). We also had a preference for Python.</p> <p><strong>Why build something new?</strong> We looked around at the existing <a href="https://github.com/git-lfs/git-lfs/wiki/Implementations" target="_blank" rel="noopener noreferrer">Git LFS server implementations<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and couldn’t find one that looked like it suit our needs: there were only a few standalone servers, only one in Python, and those that did exist were usually quite out of date and supported old versions of the LFS protocol (see appendix below for further details).</p> <h2 id="giftless-api"><a href="#giftless-api" class="header-anchor">#</a> Giftless API</h2> <p>Giftless follows the <a href="https://github.com/git-lfs/git-lfs/tree/master/docs/api" target="_blank" rel="noopener noreferrer">gif-lfs API<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> in general, with the following differences and extensions:</p> <ul><li>Locking: no support at present</li> <li>Multipart: giftless adds support for multi-part transfers. See XXX for details</li> <li>Giftless adds optional support for <code>x-filename</code> object property, which allows specifying the filename of an object in storage (this allows storage backends to set the “Content-disposition” header when the file is downloaded via a browser, for example)</li></ul> <p>Below we summarize the key API endpoints.</p> <h3 id="post-foo-bar-objects-batch"><a href="#post-foo-bar-objects-batch" class="header-anchor">#</a> <code>POST /foo/bar/objects/batch</code></h3> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;transfers&quot;: [&quot;multipart-basic&quot;, &quot;basic&quot;],
  &quot;operation&quot;: &quot;upload&quot;,
  &quot;objects&quot;: [
    {
      &quot;oid&quot;: &quot;20492a4d0d84f8beb1767f6616229f85d44c2827b64bdbfb260ee12fa1109e0e&quot;,
      &quot;size&quot;: 10000000
    }
  ]
}
</code></pre></div><h3 id="optional-api-endpoints"><a href="#optional-api-endpoints" class="header-anchor">#</a> Optional API endpoints</h3> <p>The following endpoints are also exposed by Giftless, but may not be used in some workflows, depending on your setup:</p> <h4 id="post-foo-bar-objects-storage-verify"><a href="#post-foo-bar-objects-storage-verify" class="header-anchor">#</a> <code>POST /foo/bar/objects/storage/verify</code></h4> <p>Verify an object in storage; This is used by different storage backends to check<br>
a file after it has been uploaded, corresponding to the Git LFS <code>verify</code> action.</p> <h4 id="put-foo-bar-objects-storage"><a href="#put-foo-bar-objects-storage" class="header-anchor">#</a> <code>PUT /foo/bar/objects/storage</code></h4> <p>Store an object in local storage; This is only used if Giftless is configured to also<br>
act as the storage backend server, which is not a typical production setup. This accepts<br>
the file to be uploaded as HTTP request body.</p> <p>An optional <code>?jwt=...</code> query parameter can be added to specify a JWT auth token, if JWT<br>
auth is in use.</p> <h4 id="get-foo-bar-objects-storage"><a href="#get-foo-bar-objects-storage" class="header-anchor">#</a> <code>GET /foo/bar/objects/storage</code></h4> <p>Fetch an object from local storage; This is only used if Giftless is configured to also<br>
act as the storage backend server, which is not a typical production setup. This will<br>
return the file contents.</p> <p>An optional <code>?jwt=...</code> query parameter can be added to specify a JWT auth token, if JWT<br>
auth is in use.</p> <h3 id="comment-why-the-slightly-weird-api-layout"><a href="#comment-why-the-slightly-weird-api-layout" class="header-anchor">#</a> Comment: why the slightly weird API layout</h3> <p>The essence of giftless is to hand out tokens to store or get data in blob storage. One would anticipae the basic API to be a bit simpler e.g. something like implemented in our earlier effort <code>bitstore</code>: <a href="https://github.com/datopian/bitstore#get-authorized-upload-urls" target="_blank" rel="noopener noreferrer">https://github.com/datopian/bitstore#get-authorized-upload-urls<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-json= extra-class"><pre class="language-text"><code>POST /authorize

{
    &quot;metadata&quot;: {
        &quot;owner&quot;: &quot;&lt;user-id-of-uploader&gt;&quot;,
        &quot;name&quot;: &quot;&lt;data-set-unique-id&gt;&quot;
    },
    &quot;filedata&quot;: {
        &quot;filepath&quot;: {
            &quot;length&quot;: 1234, #length in bytes of data
            &quot;md5&quot;: &quot;&lt;md5-hash-of-the-data&gt;&quot;,
            &quot;type&quot;: &quot;&lt;content-type-of-the-data&gt;&quot;,
            &quot;name&quot;: &quot;&lt;file-name&gt;&quot;
        },
        &quot;filepath-2&quot;: {
            &quot;length&quot;: 4321,
            &quot;md5&quot;: &quot;&lt;md5-hash-of-the-data&gt;&quot;,
            &quot;type&quot;: &quot;&lt;content-type-of-the-data&gt;&quot;,
            &quot;name&quot;: &quot;&lt;file-name&gt;&quot;
        }
        ...
    }
}
</code></pre></div><p>However, the origins of git lfs with github means that it has a slightly odd setup whereby the start of the url is <code>/foo/bar</code> corresponding to <code>{org}/{repo}</code>.</p> <h2 id="mapping-from-giftless-to-storage"><a href="#mapping-from-giftless-to-storage" class="header-anchor">#</a> Mapping from Giftless to Storage</h2> <p>One important question when using giftless is how a file maps from api call to storage …</p> <p>This call:</p> <div class="language- extra-class"><pre class="language-text"><code>/foo/bar/objects/batch

oid: (sha256) xxxx
</code></pre></div><p>Maps in storage to …</p> <div class="language- extra-class"><pre class="language-text"><code>storage-bucket/{prefix}/foo/bar/xxx
</code></pre></div><p>Where <code>{prefix}</code> is configured as env variable to Giftless server (and can be empty)</p> <h2 id="authentication-and-authorization"><a href="#authentication-and-authorization" class="header-anchor">#</a> Authentication and Authorization</h2> <p>How does giftless determine that you are allowed to upload to</p> <div class="language- extra-class"><pre class="language-text"><code>/foo/bar/objects/batch

oid: XXXX
</code></pre></div><p>Does that based on scopes on jwt token …</p> <p>See <a href="https://github.com/datopian/giftless/blob/feature/21-improve-documentation/docs/source/auth-providers.md" target="_blank" rel="noopener noreferrer">https://github.com/datopian/giftless/blob/feature/21-improve-documentation/docs/source/auth-providers.md<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for more details.</p> <h2 id="use-with-git"><a href="#use-with-git" class="header-anchor">#</a> Use with git</h2> <p><a href="https://github.com/git-lfs/git-lfs/blob/master/docs/api/server-discovery.md" target="_blank" rel="noopener noreferrer">https://github.com/git-lfs/git-lfs/blob/master/docs/api/server-discovery.md<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Set <code>.lfsconfig</code></p> <h2 id="appendix-summary-of-git-lfs"><a href="#appendix-summary-of-git-lfs" class="header-anchor">#</a> Appendix: Summary of Git LFS</h2> <p><a href="https://github.com/git-lfs/git-lfs/blob/master/docs/api/batch.md" target="_blank" rel="noopener noreferrer">https://github.com/git-lfs/git-lfs/blob/master/docs/api/batch.md<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li>TODO: sequence diagram of git interaction with gif lfs server</li> <li>TODO: summary of server API</li></ul> <h3 id="summary-of-interaction-for-git-client"><a href="#summary-of-interaction-for-git-client" class="header-anchor">#</a> Summary of interaction (for git client)</h3> <ul><li>Perform server discovery to discover the git lfs server: <a href="https://github.com/git-lfs/git-lfs/blob/master/docs/api/server-discovery.md" target="_blank" rel="noopener noreferrer">https://github.com/git-lfs/git-lfs/blob/master/docs/api/server-discovery.md<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <ul><li>Use <code>.lfsconfig</code> if it exists</li> <li>Default: Git LFS appends .git/info/lfs to the end of a Git remote url to build the LFS server URL it will use:</li></ul></li> <li>Authentication (?)</li> <li>Send a <code>batch</code> API call to the server configured in the Git client’s .lfsconfig (TODO: verify config location)
<ul><li>The specifics of the <code>batch</code> request depend on the current operation being performed and the objects (that is files) operated on;</li></ul></li> <li>The response to <code>batch</code> includes “instructions” on how to download / upload files to storage
<ul><li>Storage can be on the same server as Git LFS (in some dedicated endpoints) or on a whole different server, for example S3 or Google Cloud Storage</li> <li>Git LFS defines a few “transfer modes” which define how to communicate with the storage server; The most basic mode (known as <code>&quot;basic&quot;</code>), uses HTTP GET and PUT to download / upload the files given a URL and some headers.</li> <li>There could be other transfer modes - for example, Giftless defines a custom transfer mode called <code>multipart-basic</code> which is specifically designed to take advantage of Cloud storage vendors’ multipart upload features.</li></ul></li> <li>Based on the transfer mode &amp; instructions (typically URL &amp; headers) specified in the response to the <code>batch</code> call, the git lfs client will now interact with the storage server to upload / download files</li></ul> <h3 id="how-git-lfs-works-for-git-locally"><a href="#how-git-lfs-works-for-git-locally" class="header-anchor">#</a> How git lfs works for git locally</h3> <ul><li>Have special git lfs blob storage in git directory</li> <li>On checkout pull from that blob store rather than standard one</li> <li>on Add and commit write a pointer file inito “git” tree instead of actual file and put file in git lfs blob storage</li> <li>On push: push git lfs blobs to blob server</li> <li>On pull: pull git lfs blobs that i need for current checkout
<ul><li>TODO: do i pull other stuff?</li></ul></li></ul> <h3 id="git-lfs-server-api"><a href="#git-lfs-server-api" class="header-anchor">#</a> Git LFS Server API</h3> <p><a href="https://github.com/git-lfs/git-lfs/tree/master/docs/api" target="_blank" rel="noopener noreferrer">https://github.com/git-lfs/git-lfs/tree/master/docs/api<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="batch-api"><a href="#batch-api" class="header-anchor">#</a> Batch API</h3> <p><a href="https://github.com/git-lfs/git-lfs/blob/master/docs/api/batch.md" target="_blank" rel="noopener noreferrer">https://github.com/git-lfs/git-lfs/blob/master/docs/api/batch.md<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>TODO: summarize here.</p> <h2 id="appendix-existing-git-lfs-server-implementations"><a href="#appendix-existing-git-lfs-server-implementations" class="header-anchor">#</a> Appendix: Existing Git LFS server implementations</h2> <p>A review of some of the existing GIT LFS server implementations.</p> <ul><li><a href="https://github.com/kzwang/node-git-lfs" target="_blank" rel="noopener noreferrer">https://github.com/kzwang/node-git-lfs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> Node, well developed but now archived and last updated 5y ago. This implementation provided inspiration for giftless.</li> <li><a href="https://github.com/mgax/lfs:" target="_blank" rel="noopener noreferrer">https://github.com/mgax/lfs:<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> Python, only speaks legacy v1 API and last updated properly ~2y ago</li> <li><a href="https://github.com/meltingice/git-lfs-s3" target="_blank" rel="noopener noreferrer">https://github.com/meltingice/git-lfs-s3<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> - Ruby, repo is archived. Last updated 6y ago.</li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/datopian/tech.datopian.com/edit/master/giftless/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Modified:</span> <span class="time">2/18/2021, 8:39:08 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.cae7a747.js" defer></script><script src="/assets/js/3.fa4bc789.js" defer></script><script src="/assets/js/61.d50d013c.js" defer></script>
  </body>
</html>
