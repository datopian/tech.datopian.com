(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{414:function(e,t,a){"use strict";a.r(t);var n=a(18),o=Object(n.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"redeploy-a-frontend-app-to-ckan-cloud"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redeploy-a-frontend-app-to-ckan-cloud"}},[e._v("#")]),e._v(" Redeploy A frontend APP To CKAN Cloud")]),e._v(" "),a("h2",{attrs:{id:"make-changes-to-a-deployed-instance"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#make-changes-to-a-deployed-instance"}},[e._v("#")]),e._v(" Make changes to a deployed instance")]),e._v(" "),a("p",[e._v("Let‚Äôs say you need to make several changes to the frontend app we created in "),a("RouterLink",{attrs:{to:"/deploy/deploy-ng.html"}},[e._v("Deploy Frontend APP To CKAN Cloud")]),e._v(":")],1),e._v(" "),a("ul",[a("li",[e._v("Enable a new theme.")]),e._v(" "),a("li",[e._v("Deploy the latest version of "),a("a",{attrs:{href:"https://github.com/datopian/frontend-v2",target:"_blank",rel:"noopener noreferrer"}},[e._v("frontend-v2"),a("OutboundLink")],1)]),e._v(" "),a("li",[e._v("Updating Environment variables.")])]),e._v(" "),a("h3",{attrs:{id:"enable-a-new-theme"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#enable-a-new-theme"}},[e._v("#")]),e._v(" Enable a new theme")]),e._v(" "),a("p",[e._v("All you need to do is update the Dockerfile. Frontend applications are Node-js apps that are cloned in the "),a("code",[e._v("themes")]),e._v(" directory.")]),e._v(" "),a("ul",[a("li",[e._v("Go to "),a("a",{attrs:{href:"https://gitlab.com/viderum/cloud-deploy-demo-exercise-ng/edit/master/Dockerfile",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://gitlab.com/viderum/cloud-deploy-demo-exercise-ng/edit/master/Dockerfile"),a("OutboundLink")],1)]),e._v(" "),a("li",[e._v("Uncomment the commented part (remove)"),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# RUN git clone https://cloud-service-account:password@gitlab.com/datopian/clients/[client-id] ./themes/client-id\n# RUN cd client-id && yarn && cd -\n")])])])]),e._v(" "),a("li",[e._v("Replace the "),a("code",[e._v("[client-id]")]),e._v(" with the actual client name and save the changes.")])]),e._v(" "),a("p",[a("strong",[a("em",[e._v("Note:")])]),e._v(" Client repos are usually private. You can re-use the token for the "),a("code",[e._v("cloud-service-account")]),e._v(".")]),e._v(" "),a("h3",{attrs:{id:"update-environment-variables"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#update-environment-variables"}},[e._v("#")]),e._v(" Update environment variables")]),e._v(" "),a("p",[e._v("In order to add/remove/update environment variables, you only need to change them in the "),a("code",[e._v("Dockerfile")]),e._v(". See other environment variables as an example. The conventon is:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("ENV ENV_KEY=ENV_VALUE\n")])])]),a("h2",{attrs:{id:"deploy-the-new-version-of-frontend-v2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#deploy-the-new-version-of-frontend-v2"}},[e._v("#")]),e._v(" Deploy the new version of frontend-v2")]),e._v(" "),a("p",[e._v("We are not versioning frontend-v2, so all you need to do is trigger the latest GitLab-CI build.")]),e._v(" "),a("ul",[a("li",[e._v("Go to "),a("a",{attrs:{href:"https://gitlab.com/viderum/cloud-deploy-demo-exercise-ng",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://gitlab.com/viderum/cloud-deploy-demo-exercise-ng"),a("OutboundLink")],1)]),e._v(" "),a("li",[e._v("Click the Green tick button and restart")])]),e._v(" "),a("p",[a("img",{attrs:{src:"https://i.imgur.com/jsob5Ji.png",alt:""}})]),e._v(" "),a("p",[e._v("This will trigger a new build, and the new image will include the latest commits from the master branch")]),e._v(" "),a("h2",{attrs:{id:"redeploy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redeploy"}},[e._v("#")]),e._v(" Redeploy")]),e._v(" "),a("p",[e._v("Commit the changes and wait until the build is successful.")]),e._v(" "),a("p",[a("img",{attrs:{src:"https://i.imgur.com/v7b8Z1c.png",alt:""}})]),e._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),a("p",[e._v("If the build is not successful, check its logs. You might have a typo in your branch, release name, etc‚Ä¶")])]),e._v(" "),a("ul",[a("li",[e._v("Open "),a("a",{attrs:{href:"https://cc-p-jenkins.ckan.io/job/deploy%20frontend%20instance/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Deploy frontend instance"),a("OutboundLink")],1)]),e._v(" "),a("li",[e._v("Click ‚ÄúBuild with Parameters‚Äù button")]),e._v(" "),a("li",[e._v("Fill "),a("code",[e._v("INSTANCE_NAME")]),e._v(" parameter with "),a("code",[e._v("deploy-demo-exercise-ng")])]),e._v(" "),a("li",[e._v("Fill "),a("code",[e._v("REGISTRY_REPO")]),e._v(" parameter with "),a("code",[e._v("viderum/cloud-[instance-id]")]),e._v(" ("),a("code",[e._v("viderum/cloud-deploy-demo-exercise-ng")]),e._v(")")]),e._v(" "),a("li",[e._v("Click ‚ÄúBuild‚Äù button")])]),e._v(" "),a("p",[a("img",{attrs:{src:"https://i.imgur.com/8GEjebX.png",alt:""}})]),e._v(" "),a("p",[e._v("Wait for the successful build, and that‚Äôs it! You‚Äôve just deployed your changes to the CKAN cloud servers üöÄ")])])}),[],!1,null,null,null);t.default=o.exports}}]);