<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>CKAN Client Guide | Datopian Tech</title>
    <meta name="generator" content="VuePress 1.4.1">
    
    <meta name="description" content="An overview of our technology">
    <link rel="preload" href="/assets/css/0.styles.2870a88c.css" as="style"><link rel="preload" href="/assets/js/app.59a08162.js" as="script"><link rel="preload" href="/assets/js/3.d5d0a0d8.js" as="script"><link rel="preload" href="/assets/js/15.7607ad8f.js" as="script"><link rel="prefetch" href="/assets/js/10.e7e6d19f.js"><link rel="prefetch" href="/assets/js/11.05075ec2.js"><link rel="prefetch" href="/assets/js/12.99d2f2e9.js"><link rel="prefetch" href="/assets/js/13.ebe56481.js"><link rel="prefetch" href="/assets/js/14.be40ebd0.js"><link rel="prefetch" href="/assets/js/16.828eb858.js"><link rel="prefetch" href="/assets/js/17.8bdbc3b2.js"><link rel="prefetch" href="/assets/js/18.4b32168f.js"><link rel="prefetch" href="/assets/js/19.9331b1ce.js"><link rel="prefetch" href="/assets/js/20.2506793a.js"><link rel="prefetch" href="/assets/js/21.5df00edd.js"><link rel="prefetch" href="/assets/js/22.0a8334d1.js"><link rel="prefetch" href="/assets/js/23.9f8a2052.js"><link rel="prefetch" href="/assets/js/24.10bf6a23.js"><link rel="prefetch" href="/assets/js/25.6fea73c9.js"><link rel="prefetch" href="/assets/js/26.2cd12626.js"><link rel="prefetch" href="/assets/js/27.5b84a66f.js"><link rel="prefetch" href="/assets/js/28.56e20ee9.js"><link rel="prefetch" href="/assets/js/29.9da0cfd4.js"><link rel="prefetch" href="/assets/js/30.54219014.js"><link rel="prefetch" href="/assets/js/31.7fc22d93.js"><link rel="prefetch" href="/assets/js/32.772d5b23.js"><link rel="prefetch" href="/assets/js/33.11e65ce9.js"><link rel="prefetch" href="/assets/js/34.5a470e8a.js"><link rel="prefetch" href="/assets/js/35.b2976562.js"><link rel="prefetch" href="/assets/js/36.d9ab4286.js"><link rel="prefetch" href="/assets/js/37.27a3d0a8.js"><link rel="prefetch" href="/assets/js/38.a7c4fd01.js"><link rel="prefetch" href="/assets/js/39.c29a08c9.js"><link rel="prefetch" href="/assets/js/4.421f6159.js"><link rel="prefetch" href="/assets/js/40.c355f824.js"><link rel="prefetch" href="/assets/js/41.9a857659.js"><link rel="prefetch" href="/assets/js/42.204a8c44.js"><link rel="prefetch" href="/assets/js/43.c2016243.js"><link rel="prefetch" href="/assets/js/44.fd1c2c89.js"><link rel="prefetch" href="/assets/js/45.147cf8e8.js"><link rel="prefetch" href="/assets/js/46.d4a89a47.js"><link rel="prefetch" href="/assets/js/47.350d6280.js"><link rel="prefetch" href="/assets/js/48.7d584adc.js"><link rel="prefetch" href="/assets/js/49.fb9cbba4.js"><link rel="prefetch" href="/assets/js/5.95afe96d.js"><link rel="prefetch" href="/assets/js/50.e72b1b78.js"><link rel="prefetch" href="/assets/js/51.bcadcf49.js"><link rel="prefetch" href="/assets/js/52.76bd2971.js"><link rel="prefetch" href="/assets/js/53.e1d96fad.js"><link rel="prefetch" href="/assets/js/54.43784b8b.js"><link rel="prefetch" href="/assets/js/55.79dc17e7.js"><link rel="prefetch" href="/assets/js/56.627c9324.js"><link rel="prefetch" href="/assets/js/57.1c668879.js"><link rel="prefetch" href="/assets/js/58.b7f28b13.js"><link rel="prefetch" href="/assets/js/59.1a3e2717.js"><link rel="prefetch" href="/assets/js/6.bd48916b.js"><link rel="prefetch" href="/assets/js/60.e8889dc8.js"><link rel="prefetch" href="/assets/js/61.6fd43e0a.js"><link rel="prefetch" href="/assets/js/62.9c0a9f47.js"><link rel="prefetch" href="/assets/js/63.0b2aa6e7.js"><link rel="prefetch" href="/assets/js/64.52e10826.js"><link rel="prefetch" href="/assets/js/65.33655e3b.js"><link rel="prefetch" href="/assets/js/66.7354eba9.js"><link rel="prefetch" href="/assets/js/67.5b2b8941.js"><link rel="prefetch" href="/assets/js/68.209720b1.js"><link rel="prefetch" href="/assets/js/69.63b05519.js"><link rel="prefetch" href="/assets/js/7.5da2f63f.js"><link rel="prefetch" href="/assets/js/70.bffcb2e6.js"><link rel="prefetch" href="/assets/js/71.e7ab8c87.js"><link rel="prefetch" href="/assets/js/72.acaac45d.js"><link rel="prefetch" href="/assets/js/73.577b4bba.js"><link rel="prefetch" href="/assets/js/74.015383bc.js"><link rel="prefetch" href="/assets/js/75.957a033e.js"><link rel="prefetch" href="/assets/js/76.8c351ea8.js"><link rel="prefetch" href="/assets/js/77.d1495ebd.js"><link rel="prefetch" href="/assets/js/78.4e3a09b5.js"><link rel="prefetch" href="/assets/js/79.d129c1fc.js"><link rel="prefetch" href="/assets/js/8.ab05c86f.js"><link rel="prefetch" href="/assets/js/9.077580af.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.6161fb7d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2870a88c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Datopian Tech</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Features" class="dropdown-title"><span class="title">Features</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/views/" class="nav-link">
  Views
</a></li></ul></div></div> <a href="https://github.com/datopian/tech.datopian.com" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Features" class="dropdown-title"><span class="title">Features</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/views/" class="nav-link">
  Views
</a></li></ul></div></div> <a href="https://github.com/datopian/tech.datopian.com" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>CKAN Client Guide</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/ckan-client-guide/#frictionless-formats" class="sidebar-link">Frictionless Formats</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/ckan-client-guide/#quick-start" class="sidebar-link">Quick start</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ckan-client-guide/#prerequisites" class="sidebar-link">Prerequisites</a></li><li class="sidebar-sub-header"><a href="/ckan-client-guide/#upload-a-resource-file-and-implicitly-create-a-new-dataset" class="sidebar-link">Upload a resource (file) (and implicitly create a new Dataset)</a></li><li class="sidebar-sub-header"><a href="/ckan-client-guide/#create-a-new-empty-dataset-with-metadata" class="sidebar-link">Create a new empty Dataset with metadata</a></li><li class="sidebar-sub-header"><a href="/ckan-client-guide/#adding-a-resource-to-an-existing-dataset" class="sidebar-link">Adding a resource to an existing Dataset</a></li><li class="sidebar-sub-header"><a href="/ckan-client-guide/#edit-a-dataset-s-metadata" class="sidebar-link">Edit a Dataset's metadata</a></li></ul></li><li><a href="/ckan-client-guide/#api-porcelain" class="sidebar-link">API - Porcelain</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ckan-client-guide/#retrieve" class="sidebar-link">retrieve</a></li><li class="sidebar-sub-header"><a href="/ckan-client-guide/#push" class="sidebar-link">push</a></li></ul></li><li><a href="/ckan-client-guide/#api-plumbing" class="sidebar-link">API - Plumbing</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ckan-client-guide/#action-api" class="sidebar-link">Action API</a></li><li class="sidebar-sub-header"><a href="/ckan-client-guide/#storage" class="sidebar-link">Storage</a></li></ul></li><li><a href="/ckan-client-guide/#metadata-reference" class="sidebar-link">Metadata reference</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/ckan-client-guide/#design-principles" class="sidebar-link">Design Principles</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="ckan-client-guide"><a href="#ckan-client-guide" class="header-anchor">#</a> CKAN Client Guide</h1> <p>Guide to interacting with <a href="/ckan">CKAN</a> for power users such as data scientists, data engineers and data wranglers.</p> <p>This guide is about adding and managing data in CKAN programmatically and it assumes:</p> <ul><li>You are familiar with key concepts like metadata, data etc.</li> <li>You are working programmatically e.g. in one of Python, R, JavaScript, etc.</li></ul> <h2 id="frictionless-formats"><a href="#frictionless-formats" class="header-anchor">#</a> Frictionless Formats</h2> <p>Clients use <a href="https://specs.frictionlessdata.io/" target="_blank" rel="noopener noreferrer">Frictionless formats<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> by default for describing dataset and resource objects passed to client methods. Internally, we then use the a CKAN&lt;=&gt;Frictionless Mapper (<a href="https://github.com/datopian/frictionless-ckan-mapper-js" target="_blank" rel="noopener noreferrer">js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, [python][c2fpy] to convert to CKAN formats before calling the API. Thus, you can use Frictionless Formats by default with the client. (As CKAN moves to Frictionless to default this will gradually become unnecessary).</p> <h2 id="quick-start"><a href="#quick-start" class="header-anchor">#</a> Quick start</h2> <p>This guide currently uses a Python idiom by default (e.g. lower case, underscore). You can adapt to R and Javascript as needed and we provide alternative examples where possible.</p> <h3 id="prerequisites"><a href="#prerequisites" class="header-anchor">#</a> Prerequisites</h3> <p>Install the SDK for your language and configure it.</p> <ul><li>Python: <a href="https://github.com/datopian/ckan3-py-sdk#install" target="_blank" rel="noopener noreferrer">https://github.com/datopian/ckan3-py-sdk#install<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>)</li> <li>Javascript: …</li> <li>R: coming soon</li></ul> <p>### Create a client</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> ckanclient <span class="token keyword">import</span> Client

endpoint <span class="token operator">=</span> <span class="token string">'https://my-ckan.com/'</span>
token <span class="token operator">=</span> <span class="token string">'xxxx'</span>              <span class="token comment"># your CKAN API key</span>
org_name <span class="token operator">=</span> <span class="token string">'my-org'</span>         <span class="token comment"># default organization on CKAN to add datasets to</span>
client <span class="token operator">=</span> Client<span class="token punctuation">(</span>endpoint<span class="token punctuation">,</span> token<span class="token punctuation">,</span> org_name<span class="token punctuation">)</span>
</code></pre></div><h3 id="upload-a-resource-file-and-implicitly-create-a-new-dataset"><a href="#upload-a-resource-file-and-implicitly-create-a-new-dataset" class="header-anchor">#</a> Upload a resource (file) (and implicitly create a new Dataset)</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># loads a resource from a path</span>
resource <span class="token operator">=</span> f11s<span class="token punctuation">.</span>load<span class="token punctuation">(</span>resource_file_path<span class="token punctuation">)</span>
dataset_name <span class="token operator">=</span> <span class="token string">'sample-dataset'</span>
dataset <span class="token operator">=</span> f11s<span class="token punctuation">.</span>Dataset<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span> dataset_name<span class="token punctuation">}</span><span class="token punctuation">)</span>
dataset<span class="token punctuation">.</span>add_resource<span class="token punctuation">(</span>resource<span class="token punctuation">)</span>
client<span class="token punctuation">.</span>push<span class="token punctuation">(</span>resource<span class="token punctuation">)</span>
</code></pre></div><h3 id="create-a-new-empty-dataset-with-metadata"><a href="#create-a-new-empty-dataset-with-metadata" class="header-anchor">#</a> Create a new empty Dataset with metadata</h3> <div class="language-python extra-class"><pre class="language-python"><code>dataset <span class="token operator">=</span> f11s<span class="token punctuation">.</span>Dataset<span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">'name'</span><span class="token punctuation">:</span> dataset_name<span class="token punctuation">,</span>
    <span class="token string">'metadata'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'maintainer_email'</span><span class="token punctuation">:</span> <span class="token string">'sample@datopian.com'</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
client<span class="token punctuation">.</span>push<span class="token punctuation">(</span>dataset<span class="token punctuation">)</span>
</code></pre></div><h3 id="adding-a-resource-to-an-existing-dataset"><a href="#adding-a-resource-to-an-existing-dataset" class="header-anchor">#</a> Adding a resource to an existing Dataset</h3> <div class="language-python extra-class"><pre class="language-python"><code>resource <span class="token operator">=</span> f11s<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">'sample.csv'</span><span class="token punctuation">)</span>

<span class="token comment"># this will upload the file and add the resource to the dataset</span>
<span class="token comment"># NB: resource metadata e.g. name, title etc will be auto-inferred from the file</span>
client<span class="token punctuation">.</span>push_resource<span class="token punctuation">(</span>
    resource<span class="token punctuation">,</span>
    dataset<span class="token operator">=</span><span class="token string">'dataset-name'</span><span class="token punctuation">,</span>
    append<span class="token operator">=</span><span class="token boolean">True</span>
<span class="token punctuation">)</span>
</code></pre></div><h3 id="edit-a-dataset-s-metadata"><a href="#edit-a-dataset-s-metadata" class="header-anchor">#</a> Edit a Dataset’s metadata</h3> <blockquote><p>WARNING: Not implemented yet.</p></blockquote> <div class="language-python extra-class"><pre class="language-python"><code>dataset <span class="token operator">=</span> client<span class="token punctuation">.</span>get_dataset<span class="token punctuation">(</span>dataset_name<span class="token operator">=</span><span class="token string">'sample_dataset'</span><span class="token punctuation">)</span>
client<span class="token punctuation">.</span>update_metadata<span class="token punctuation">(</span>
    dataset<span class="token punctuation">,</span>
    metadata<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'maintainer_email'</span><span class="token punctuation">:</span> <span class="token string">'sample@datopian.com'</span><span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre></div><p>For details of metadata see the metadata reference below …</p> <h2 id="api-porcelain"><a href="#api-porcelain" class="header-anchor">#</a> API - Porcelain</h2> <h3 id="retrieve"><a href="#retrieve" class="header-anchor">#</a> <code>retrieve</code></h3> <h3 id="push"><a href="#push" class="header-anchor">#</a> <code>push</code></h3> <h2 id="api-plumbing"><a href="#api-plumbing" class="header-anchor">#</a> API - Plumbing</h2> <h3 id="action-api"><a href="#action-api" class="header-anchor">#</a> Action API</h3> <h3 id="storage"><a href="#storage" class="header-anchor">#</a> Storage</h3> <h2 id="metadata-reference"><a href="#metadata-reference" class="header-anchor">#</a> Metadata reference</h2> <div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>Your site may have custom metadata that differs from the default set below.</p></div> <p>## Generating templates</p> <p>TODO</p> <h2 id="design-principles"><a href="#design-principles" class="header-anchor">#</a> Design Principles</h2> <p>The client SHOULD use Frictionless formats by default for describing dataset and resource objects passed to client methods.</p> <p>In addition, where more than metadata is needed (e.g. we need to access the data stream of get the schema) we expect the Dataset and Resource object to follow the Frictionless Data Lib pattern <a href="https://github.com/frictionlessdata/project/blob/master/rfcs/0004-frictionless-data-lib-pattern.md" target="_blank" rel="noopener noreferrer">https://github.com/frictionlessdata/project/blob/master/rfcs/0004-frictionless-data-lib-pattern.md<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/datopian/tech.datopian.com/edit/master/ckan-client-guide/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Modified:</span> <span class="time">10/5/2020, 3:53:35 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.59a08162.js" defer></script><script src="/assets/js/3.d5d0a0d8.js" defer></script><script src="/assets/js/15.7607ad8f.js" defer></script>
  </body>
</html>
