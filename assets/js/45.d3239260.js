(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{439:function(e,t,a){"use strict";a.r(t);var n=a(25),s=Object(n.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"redeploy-to-ckan-cloud"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redeploy-to-ckan-cloud"}},[e._v("#")]),e._v(" Redeploy To CKAN Cloud")]),e._v(" "),a("h2",{attrs:{id:"make-changes-to-a-deployed-instance"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#make-changes-to-a-deployed-instance"}},[e._v("#")]),e._v(" Make changes to a deployed instance")]),e._v(" "),a("p",[e._v("Let‚Äôs say you need to make several changes to the portal we created in "),a("RouterLink",{attrs:{to:"/deploy/#creating-ckan-portal-deploying-for-first-time"}},[e._v("Creating CKAN Portal - Deploying for first time")]),e._v(":")],1),e._v(" "),a("ul",[a("li",[e._v("Enable a new extension.")]),e._v(" "),a("li",[e._v("Update the version of an existing extension.")]),e._v(" "),a("li",[e._v("Update Environment variables.")])]),e._v(" "),a("h3",{attrs:{id:"install-a-new-extension"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#install-a-new-extension"}},[e._v("#")]),e._v(" Install a new extension")]),e._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),a("p",[e._v("CKAN Extensions are installed inside the docker containers during the build with "),a("code",[e._v("pip install")]),e._v(". Normally, CKAN extensions are stored in GitHub repositories, and we install from there, but they can be stored anywhere (e.g. GitLab, PyPI, Bitbucket, etc‚Ä¶)")]),e._v(" "),a("p",[e._v("Extensions can be installed in the following ways:")]),e._v(" "),a("ul",[a("li",[e._v("From master branch")]),e._v(" "),a("li",[e._v("From new release or tag")]),e._v(" "),a("li",[e._v("From the exact commit")])])]),e._v(" "),a("p",[e._v("Let‚Äôs install the "),a("a",{attrs:{href:"https://github.com/rclark/ckanext-helloworld",target:"_blank",rel:"noopener noreferrer"}},[e._v("Hello World Extension"),a("OutboundLink")],1),e._v(" on our portal. To do this, we need to modify the Dockerfile - edit "),a("a",{attrs:{href:"https://gitlab.com/viderum/cloud-deploy-demo-exercise/edit/master/Dockerfile",target:"_blank",rel:"noopener noreferrer"}},[e._v("cloud-deploy-demo-exercise Dockerfile"),a("OutboundLink")],1),e._v(" and uncomment the following line:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("#RUN pip install --no-cache-dir git+https://github.com/rclark/ckanext-helloworld.git#egg=ckanext-helloworld\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),a("p",[e._v("Alternatively, you can add that line to the existing "),a("code",[e._v("pip install")]),e._v(" section:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("RUN pip install --no-cache-dir git+https://github.com/datopian/ckanext-s3filestore.git@fix-null-content-type#egg=ckanext-s3filestore && \\\n    pip install --no-cache-dir -r https://raw.githubusercontent.com/datopian/ckanext-s3filestore/fix-null-content-type/requirements.txt &&\\\n    pip install --no-cache-dir git+https://github.com/okfn/ckanext-sentry.git#egg=ckanext-sentry && \\\n    pip install --no-cache-dir git+https://github.com/rclark/ckanext-helloworld.git#egg=ckanext-helloworld\n")])])])]),e._v(" "),a("h3",{attrs:{id:"install-requirements-for-an-extension"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#install-requirements-for-an-extension"}},[e._v("#")]),e._v(" Install requirements for an extension")]),e._v(" "),a("p",[e._v("Some extensions have their own dependencies that are usually placed in the same repositories under the name "),a("code",[e._v("requirements.txt")]),e._v(" (or similar). In the example below, the second line is used to install the dependencies for the "),a("code",[e._v("ckanext-s3filestore")]),e._v(" extension:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("RUN pip install --no-cache-dir git+https://github.com/datopian/ckanext-s3filestore.git#egg=ckanext-s3filestore && \\\n    pip install --no-cache-dir -r https://raw.githubusercontent.com/datopian/ckanext-s3filestore/requirements.txt &&\\\n    ...\n")])])]),a("h3",{attrs:{id:"update-versions-of-extensions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#update-versions-of-extensions"}},[e._v("#")]),e._v(" Update versions of extensions")]),e._v(" "),a("p",[e._v("Let‚Äôs say we want to install the following extensions:")]),e._v(" "),a("ul",[a("li",[e._v("ckanext-s3filestore from master branch")]),e._v(" "),a("li",[e._v("ckanext-sentry from "),a("a",{attrs:{href:"https://github.com/okfn/ckanext-sentry/releases/tag/0.0.1",target:"_blank",rel:"noopener noreferrer"}},[e._v("0.0.1 release"),a("OutboundLink")],1)]),e._v(" "),a("li",[e._v("ckanext-helloworld from "),a("a",{attrs:{href:"https://github.com/rclark/ckanext-helloworld/commit/b78a7815b1fa0fdc4347c47287587ab880965f07",target:"_blank",rel:"noopener noreferrer"}},[e._v("b78a7815b1fa0fdc4347c47287587ab880965f07 commit"),a("OutboundLink")],1)])]),e._v(" "),a("p",[e._v("All you need to do is update the URLs appropriately:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("RUN pip install --no-cache-dir git+https://github.com/datopian/ckanext-s3filestore.git#egg=ckanext-s3filestore && \\\n    pip install --no-cache-dir -r https://raw.githubusercontent.com/datopian/ckanext-s3filestore/requirements.txt &&\\\n    pip install --no-cache-dir git+https://github.com/okfn/ckanext-sentry.git@0.0.1#egg=ckanext-sentry && \\\n    pip install -e git+https://github.com/rclark/ckanext-helloworld.git@b78a7815b1fa0fdc4347c47287587ab880965f07#egg=ckanext-helloworld\n")])])]),a("h3",{attrs:{id:"update-environment-variables"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#update-environment-variables"}},[e._v("#")]),e._v(" Update environment variables")]),e._v(" "),a("p",[e._v("In order to add/remove/update environment variables, all you need to do is modify the "),a("a",{attrs:{href:"https://gitlab.com/viderum/cloud-deploy-demo-exercise/blob/master/.env",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v(".env")]),a("OutboundLink")],1),e._v(" file and save the changes.")]),e._v(" "),a("h2",{attrs:{id:"redeploy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redeploy"}},[e._v("#")]),e._v(" Redeploy")]),e._v(" "),a("p",[e._v("Commit the changes and wait until the build is successful.")]),e._v(" "),a("p",[a("img",{attrs:{src:"https://i.imgur.com/v7b8Z1c.png",alt:""}})]),e._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),a("p",[e._v("If the build is not successful, check its logs. You might have a typo in your branch, release name, etc‚Ä¶")])]),e._v(" "),a("ul",[a("li",[e._v("Open "),a("a",{attrs:{href:"https://cc-p-jenkins.ckan.io/job/deploy%20instance/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Deploy Instance Job"),a("OutboundLink")],1)]),e._v(" "),a("li",[e._v("Click ‚ÄúBuild with Parameters‚Äù")]),e._v(" "),a("li",[e._v("Choose the instance ID ("),a("code",[e._v("deploy-demo-exercise")]),e._v(") from dropdown")]),e._v(" "),a("li",[e._v("Fill "),a("code",[e._v("REGISTRY_REPO")]),e._v(" parameter with "),a("code",[e._v("viderum/cloud-[instance-id]")]),e._v(" ("),a("code",[e._v("viderum/cloud-deploy-demo-exercise")]),e._v(")")]),e._v(" "),a("li",[e._v("Click ‚ÄúBuild‚Äù button")])]),e._v(" "),a("p",[a("img",{attrs:{src:"https://i.imgur.com/MeGaGOZ.png",alt:""}})]),e._v(" "),a("p",[e._v("Wait for the successful build, and that‚Äôs it! You‚Äôve just deployed your changes to the CKAN cloud servers üöÄ")]),e._v(" "),a("h2",{attrs:{id:"next-steps"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#next-steps"}},[e._v("#")]),e._v(" Next Steps")]),e._v(" "),a("p",[a("a",{attrs:{href:"/deploy/deploy-ckan-ng"}},[e._v("Deploy A Frontend APP To CKAN Cloud")])])])}),[],!1,null,null,null);t.default=s.exports}}]);