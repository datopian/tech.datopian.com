<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Publish Data | Datopian Tech</title>
    <meta name="generator" content="VuePress 1.7.0">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-XESJBM03F5"></script>
    <script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-XESJBM03F5');</script>
    <meta name="description" content="An overview of our technology">
    
    <link rel="preload" href="/assets/css/0.styles.d75de8d6.css" as="style"><link rel="preload" href="/assets/js/app.63098cb8.js" as="script"><link rel="preload" href="/assets/js/3.d799bd9e.js" as="script"><link rel="preload" href="/assets/js/76.203d13f0.js" as="script"><link rel="prefetch" href="/assets/js/10.a7fa9182.js"><link rel="prefetch" href="/assets/js/11.17e0f31f.js"><link rel="prefetch" href="/assets/js/12.9c156b85.js"><link rel="prefetch" href="/assets/js/13.6eb9e3f2.js"><link rel="prefetch" href="/assets/js/14.c3eb8d6a.js"><link rel="prefetch" href="/assets/js/15.78b82eed.js"><link rel="prefetch" href="/assets/js/16.0706ce2b.js"><link rel="prefetch" href="/assets/js/17.01bc70f8.js"><link rel="prefetch" href="/assets/js/18.8b6554d2.js"><link rel="prefetch" href="/assets/js/19.21c8357b.js"><link rel="prefetch" href="/assets/js/20.7083d06c.js"><link rel="prefetch" href="/assets/js/21.37c39eb2.js"><link rel="prefetch" href="/assets/js/22.754367dc.js"><link rel="prefetch" href="/assets/js/23.9c23b15e.js"><link rel="prefetch" href="/assets/js/24.a3608064.js"><link rel="prefetch" href="/assets/js/25.c3ac8418.js"><link rel="prefetch" href="/assets/js/26.bc26ecc9.js"><link rel="prefetch" href="/assets/js/27.ce6779fb.js"><link rel="prefetch" href="/assets/js/28.bc68c583.js"><link rel="prefetch" href="/assets/js/29.afed14f9.js"><link rel="prefetch" href="/assets/js/30.c8803030.js"><link rel="prefetch" href="/assets/js/31.ec9a756e.js"><link rel="prefetch" href="/assets/js/32.42c71343.js"><link rel="prefetch" href="/assets/js/33.8085ba37.js"><link rel="prefetch" href="/assets/js/34.83c0c257.js"><link rel="prefetch" href="/assets/js/35.ae8f0e52.js"><link rel="prefetch" href="/assets/js/36.c56fa4f9.js"><link rel="prefetch" href="/assets/js/37.dd5be133.js"><link rel="prefetch" href="/assets/js/38.dbce98b5.js"><link rel="prefetch" href="/assets/js/39.dea553d4.js"><link rel="prefetch" href="/assets/js/4.3122edaf.js"><link rel="prefetch" href="/assets/js/40.d720389c.js"><link rel="prefetch" href="/assets/js/41.645c4c30.js"><link rel="prefetch" href="/assets/js/42.099c6f38.js"><link rel="prefetch" href="/assets/js/43.93c6114c.js"><link rel="prefetch" href="/assets/js/44.88f00e9e.js"><link rel="prefetch" href="/assets/js/45.2c3c216f.js"><link rel="prefetch" href="/assets/js/46.e2d887f4.js"><link rel="prefetch" href="/assets/js/47.787e7aea.js"><link rel="prefetch" href="/assets/js/48.316cbfd7.js"><link rel="prefetch" href="/assets/js/49.631989b3.js"><link rel="prefetch" href="/assets/js/5.a6f946d8.js"><link rel="prefetch" href="/assets/js/50.e689997c.js"><link rel="prefetch" href="/assets/js/51.94674a0a.js"><link rel="prefetch" href="/assets/js/52.523e96ba.js"><link rel="prefetch" href="/assets/js/53.811cb69c.js"><link rel="prefetch" href="/assets/js/54.c5a9ab06.js"><link rel="prefetch" href="/assets/js/55.8a0f4204.js"><link rel="prefetch" href="/assets/js/56.a29563d1.js"><link rel="prefetch" href="/assets/js/57.835aab72.js"><link rel="prefetch" href="/assets/js/58.8f0eabe5.js"><link rel="prefetch" href="/assets/js/59.fa5e629f.js"><link rel="prefetch" href="/assets/js/6.1e7b98e6.js"><link rel="prefetch" href="/assets/js/60.681e54dd.js"><link rel="prefetch" href="/assets/js/61.8bba1399.js"><link rel="prefetch" href="/assets/js/62.c8f2dd0b.js"><link rel="prefetch" href="/assets/js/63.20e461a7.js"><link rel="prefetch" href="/assets/js/64.415e8581.js"><link rel="prefetch" href="/assets/js/65.dab64550.js"><link rel="prefetch" href="/assets/js/66.aced021b.js"><link rel="prefetch" href="/assets/js/67.144ba192.js"><link rel="prefetch" href="/assets/js/68.698dda9c.js"><link rel="prefetch" href="/assets/js/69.cf1f44bc.js"><link rel="prefetch" href="/assets/js/7.1bee4d5a.js"><link rel="prefetch" href="/assets/js/70.5fea0f6c.js"><link rel="prefetch" href="/assets/js/71.fd3a5eec.js"><link rel="prefetch" href="/assets/js/72.95f45bd4.js"><link rel="prefetch" href="/assets/js/73.9d97dbd0.js"><link rel="prefetch" href="/assets/js/74.5420145d.js"><link rel="prefetch" href="/assets/js/75.4c9aee5b.js"><link rel="prefetch" href="/assets/js/77.7f4f72ab.js"><link rel="prefetch" href="/assets/js/78.ecd8ea0a.js"><link rel="prefetch" href="/assets/js/79.c1dbeae7.js"><link rel="prefetch" href="/assets/js/8.ced61209.js"><link rel="prefetch" href="/assets/js/80.21a62968.js"><link rel="prefetch" href="/assets/js/81.38a186b0.js"><link rel="prefetch" href="/assets/js/82.084e104a.js"><link rel="prefetch" href="/assets/js/83.7fab6c49.js"><link rel="prefetch" href="/assets/js/84.136c88f8.js"><link rel="prefetch" href="/assets/js/85.1b216135.js"><link rel="prefetch" href="/assets/js/86.c749ef07.js"><link rel="prefetch" href="/assets/js/9.44e9b202.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.62a8c583.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d75de8d6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Datopian Tech</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Features" class="dropdown-title"><span class="title">Features</span> <span class="arrow down"></span></button> <button type="button" aria-label="Features" class="mobile-dropdown-title"><span class="title">Features</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/views/" class="nav-link">
  Views
</a></li></ul></div></div> <a href="https://github.com/datopian/tech.datopian.com" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Features" class="dropdown-title"><span class="title">Features</span> <span class="arrow down"></span></button> <button type="button" aria-label="Features" class="mobile-dropdown-title"><span class="title">Features</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/views/" class="nav-link">
  Views
</a></li></ul></div></div> <a href="https://github.com/datopian/tech.datopian.com" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Publish Data</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/publish/#introduction" class="sidebar-link">Introduction</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/publish/#examples" class="sidebar-link">Examples</a></li><li class="sidebar-sub-header"><a href="/publish/#features" class="sidebar-link">Features</a></li><li class="sidebar-sub-header"><a href="/publish/#job-stories" class="sidebar-link">Job Stories</a></li><li class="sidebar-sub-header"><a href="/publish/#domain-model" class="sidebar-link">Domain Model</a></li><li class="sidebar-sub-header"><a href="/publish/#principles" class="sidebar-link">Principles</a></li></ul></li><li><a href="/publish/#flows" class="sidebar-link">Flows</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/publish/#evolution-of-a-flow" class="sidebar-link">Evolution of a Flow</a></li><li class="sidebar-sub-header"><a href="/publish/#the-30-000-foot-view" class="sidebar-link">The 30,000 foot view</a></li><li class="sidebar-sub-header"><a href="/publish/#add-dataset-high-level" class="sidebar-link">Add Dataset: High Level</a></li><li class="sidebar-sub-header"><a href="/publish/#add-dataset-mid-level" class="sidebar-link">Add Dataset: Mid Level</a></li><li class="sidebar-sub-header"><a href="/publish/#dataset-metadata-editor" class="sidebar-link">Dataset Metadata editor</a></li><li class="sidebar-sub-header"><a href="/publish/#add-a-resource" class="sidebar-link">Add a Resource</a></li><li class="sidebar-sub-header"><a href="/publish/#schema-data-dictionary-for-a-resource" class="sidebar-link">Schema (Data Dictionary) for a Resource</a></li></ul></li><li><a href="/publish/#ckan-v2" class="sidebar-link">CKAN v2</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/publish/#data-dictionary" class="sidebar-link">Data Dictionary</a></li><li class="sidebar-sub-header"><a href="/publish/#issues" class="sidebar-link">Issues</a></li></ul></li><li><a href="/publish/#ckan-v3" class="sidebar-link">CKAN v3</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/publish/#design" class="sidebar-link">Design</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="publish-data"><a href="#publish-data" class="header-anchor">#</a> Publish Data</h1> <h2 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h2> <p>Publish functionality covers the whole area of creating and editing datasets and resources, including data upload. The core job story is something like:</p> <blockquote><p>When a Data Curator has a data file or dataset they want to add it to their data portal/platform quickly and easily so that it is available there.</p></blockquote> <p>Publication can be divided by its <em>mode</em>:</p> <ul><li><strong>Manual</strong>: publication is done by people via a user interfaces or other tool</li> <li><strong>Programmatic</strong>: publication is done programatically using APIs and is usually part of automated processes</li> <li><strong>Hybrid</strong>: which combines manual and programmatic. An example would be harvesting where setup and configuration may be done in a UI manually with the process then running automatically and programmatically (in addition, some new harvesting flows require manual programmatic setup e.g. writing a harvester in Python for a new source data format).</li></ul> <p><strong>Focus on Manual</strong> we will focus on the manual in this section: programmatic is by nature largely up to the client programmer (assuming the APIs are there) whilst <a href="/harvesting/">Harvesting</a> has a section of its own. That said, many concepts here are relevant for other cases e.g. material on <a href="/glossary/#profile">profiles</a> and <a href="/glossary/#schema">schemas</a>.</p> <p><strong>Data uploading</strong>: included in publish is the process of uploading data into the DMS, and specifically into <a href="/storage/">storage</a> and especially <a href="/blob-storage/">(blob) storage</a>.<br>
.</p> <h3 id="examples"><a href="#examples" class="header-anchor">#</a> Examples</h3> <p>At its simplest, a publishing process can just involve providing a few metadata fields in a form – with the data itself stored elsewhere.</p> <p>At the other end of the spectrum, we could have a multi-stage and complex process like this:</p> <ul><li>Multiple (simultaneous) resource upload with shared metadata e.g. I’m creating a timeseries dataset with the last 12 months of data and I want each file to share the same column information but to have different titles</li> <li>A variety of metadata profiles</li> <li>Data validation (prior to ingest) including checking for PII (personally identifiable infromation)</li> <li>Complex workflow related to approval e.g. only publish if at least two people have approved</li> <li>Embargoing (only make public at time X)</li></ul> <h3 id="features"><a href="#features" class="header-anchor">#</a> Features</h3> <ul><li>Create and edit datasets and resources</li> <li>File upload as part of resource creation</li> <li>Custom metadata for both profile and schemas</li></ul> <h3 id="job-stories"><a href="#job-stories" class="header-anchor">#</a> Job Stories</h3> <p>When a Data Curator has a data file or dataset they want to add it manually (e.g. via drag and drop etc) to their data portal quickly and easily so that it is avaialble there.</p> <p>More specifically: As a Data Curator I want to drop a file in and edit the metadata and have it saved in a really awesome interactive way so that the data is “imported” and of good quality (and i get feedback)</p> <h4 id="resources"><a href="#resources" class="header-anchor">#</a> Resources</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>A resource is any data item in a dataset e.g. a file.</p></div> <p>When adding a resource to a dataset I want metadata pre-entered for me (e.g. resource name from file name, encoding, …) to save time and reduce errors</p> <p>When adding a resource to a dataset I want to be able to edit the metadata whilst uploading so that I save time</p> <p>When uploading a resource’s data as part of adding a resource to a dataset I want to see upload progress so that I have a sense of how long this will take</p> <p>When adding resources to a dataset I want to be able to add and upload multiple files at once so that I save time and make one big change</p> <p>When adding a resource which is tabular (e.g. csv, excel) I want to enter the (table) schema (i.e. the names, description and types of columns) so that my data is more useable, presentable, importable (e.g. to DataStore) and validatable</p> <p>When adding a resource which is currently stored in dropbox/gdrive/onedrive I want to pull the bytes directly from there so as to speed up the upload process</p> <h3 id="domain-model"><a href="#domain-model" class="header-anchor">#</a> Domain Model</h3> <p>The domain model here is that of the <a href="">DMS</a> and we recommend visiting that page for more information. The key items are:</p> <ul><li>Project</li> <li>Dataset</li> <li>Resource</li></ul> <h3 id="principles"><a href="#principles" class="header-anchor">#</a> Principles</h3> <ul><li>Most ordinary data users don’t distinguish resources and datasets in their everyday use. They also prefer a single (denormalized) view onto their data.</li> <li>Normalization is not normal for users (it is a convenience, economisation and consistency device)</li> <li>And in any case most of us start from files not datasets (even if datasets evolve later).</li> <li>Minimize the information the user has to provide to get going. For example, does a user <em>have</em> to provide a license to start with? If that is not absolutely required leave this item for later.</li> <li>Automate where you can but only where you can guess reliably. If you do guess, give the user ability to modify. Otherwise, magic often turns into mud. For example, if we are guessing file types let the user check and correct this.</li></ul> <h2 id="flows"><a href="#flows" class="header-anchor">#</a> Flows</h2> <ul><li>Publish flows are highly custom: different platforms have different needs</li> <li>At the same time there are core components that most people will use (and customize) e.g. uploading a file, adding dataset metadata etc</li> <li>The flows shown here are therefore illustrative and inspirational rather than definitive</li></ul> <h3 id="evolution-of-a-flow"><a href="#evolution-of-a-flow" class="header-anchor">#</a> Evolution of a Flow</h3> <p>Here’s a simple illustration of how a publishing flow might evolve:</p> <div class="spinner" style="background:rgb(66, 185, 131);" data-v-1bbcb91a></div><div class="spinner" style="background:rgb(66, 185, 131);" data-v-1bbcb91a></div><div class="spinner" style="background:rgb(66, 185, 131);" data-v-1bbcb91a></div><p>PII = personally identifiable info</p> <h3 id="the-30-000-foot-view"><a href="#the-30-000-foot-view" class="header-anchor">#</a> The 30,000 foot view</h3> <div class="spinner" style="background:rgb(66, 185, 131);" data-v-1bbcb91a></div><h3 id="add-dataset-high-level"><a href="#add-dataset-high-level" class="header-anchor">#</a> Add Dataset: High Level</h3> <div class="spinner" style="background:rgb(66, 185, 131);" data-v-1bbcb91a></div><h3 id="add-dataset-mid-level"><a href="#add-dataset-mid-level" class="header-anchor">#</a> Add Dataset: Mid Level</h3> <div class="spinner" style="background:rgb(66, 185, 131);" data-v-1bbcb91a></div><p>The approach above is “file driven” rather than “metadata driven”, in the sense that you are start by providing a file rather than providing metadata.</p> <p>Here’s the metadata driven flow:</p> <div class="spinner" style="background:rgb(66, 185, 131);" data-v-1bbcb91a></div><div class="custom-block tip"><p class="custom-block-title">Comment: The file driven approach is preferable</p> <p>We think the “file driven” approach where the flow starts with a user adding and uploading a file (and then adding metadata) is preferable to an metadata driven approach where you start with a dataset and metatdata and then add files (as is the default today in CKAN).</p> <p>Why do we think a file driven approach is better? a) a file is what the user has immediately to hand b) it is concrete whilst “metadata” is abstract c) common tools for storing files e.g. Dropbox or Google Drive start with providing a file - only later, and optionally, do you rename it, move it etc.</p> <p>That said, tools like GitHub or Gitlab require one to create a “project”, albeit a minimal one, before being able to push any content. However, GitHub and Gitlab are developer oriented tools that can assume a willingness to tolerate a slightly more cumbersome UX. Furthermore, the default use case is that you have a git repo that you wish to push so the the use case of a non-technical user uploading files is clearly secondary. Finally, in these systems you can create a project just to have an issue tracker or wiki (without having fiile storage). In this case, creating the project first makes sense.</p> <p>In a DMS, we are often dealing with non-technical or semi-technical users. Thus, providing a simple, intuitive flow is preferable. That said, one may still have a very lightweight project creation flow so that we have a container for the files (just as in, say, Google Drive you already have a folder to put your files in).</p></div> <h3 id="dataset-metadata-editor"><a href="#dataset-metadata-editor" class="header-anchor">#</a> Dataset Metadata editor</h3> <p>There are lots of ways this can be designed. We always encourage minimalism.</p> <ul><li>Adding information e.g. license, description, author …</li> <li>? Default the license (and explain what the license means …)</li></ul> <h3 id="add-a-resource"><a href="#add-a-resource" class="header-anchor">#</a> Add a Resource</h3> <p>From here on, we’ll zoom in on the “publish” part of that process. Let’s start with the simplest case of adding a single resource in the form of an uploading file:</p> <div class="spinner" style="background:rgb(66, 185, 131);" data-v-1bbcb91a></div><p>Notes</p> <ul><li>Alternative to “Select a file” would be to just “Link” to a file that is already online and available</li></ul> <h3 id="schema-data-dictionary-for-a-resource"><a href="#schema-data-dictionary-for-a-resource" class="header-anchor">#</a> Schema (Data Dictionary) for a Resource</h3> <p>One part of a publishing flow would be to describe the <a href="/glossary/#schema">schema</a> for a resource. Usually, we restrict this to tabular data resources and hence this is a Table Schema.</p> <p>Usually adding and editing a schema for a resource will be an integrated part of managing the overall metadata for the resource but it can also be a standalone step. The following flow focuses solely on the add schema:</p> <div class="spinner" style="background:rgb(66, 185, 131);" data-v-1bbcb91a></div><p>Notes</p> <ul><li>We recommend using <a href="https://frictionlessdata.io/table-schema/" target="_blank" rel="noopener noreferrer">Frictionless Table Schema<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> as format for storing table schema information</li></ul> <h4 id="schema-editor"><a href="#schema-editor" class="header-anchor">#</a> Schema editor</h4> <p><strong>Fig 1.2: Schema editor wireframe</strong></p> <img src="https://docs.google.com/drawings/d/e/2PACX-1vRD7XUc9iBYjEH11Zqsfrk7tAv688UTqEJMxOg4Bc-9p4Vkrcq8Oghpe5OfimfVoEzjfDRMLeUNIP63/pub?w=695&amp;h=434"> <ul><li><p>can add title as well as description? Maybe we should have both but i often find them duplicative and why do people want a title …? (For display in charting …)</p></li> <li><p>Could pivot the display if lots of columns (e.g. have cols down left). This is traditional approach e.g. in CKAN 2 data dictionary</p> <p><img src="https://i.imgur.com/nhb5H7Q.png" alt=""></p></li></ul> <p>Advanced:</p> <ul><li>Displaying validation errors could/should be live as you change types …  (highlight with a hover)</li> <li>add semantic/taxonomy option (after format) i.e. ability to set rich type</li></ul> <h4 id="overview-deck"><a href="#overview-deck" class="header-anchor">#</a> Overview Deck</h4> <p><strong>Deck</strong>: This deck (Feb 2019) provides an overview of the core flow publishing a single tabular file e.g. CSV and includes a a basic UI mockup illustrating the flow described below.</p> <iframe src="https://docs.google.com/presentation/d/e/2PACX-1vQD09jo3Mwq-jM32rns_ehyd6GOv7cQ7F9UAK1U_jzO5G4ZgZ8ktG9rwK03-N-0XmQyJx-9kSW7-U4I/embed?start=false&amp;loop=false&amp;delayms=3000" frameborder="0" width="960" height="569" allowfullscreen="allowfullscreen" mozallowfullscreen="true" webkitallowfullscreen="true"></iframe> <h4 id="overview"><a href="#overview" class="header-anchor">#</a> Overview</h4> <p>For v1: could assume small data (e.g. &lt; 5Mb) so we can load into memory …?</p> <p><strong>Tabular data only</strong></p> <ol><li><p>Load</p> <ol><li>File select</li> <li>Detect type</li> <li>Preview                  &lt;= start preview here and continue throughout (?)</li> <li>Choose the data</li></ol></li> <li><p>Structural check and correction</p> <ol><li>Structural validation</li> <li>Error presentation</li> <li>Mini-ETL to correct errors</li></ol></li> <li><p>Table metadata</p> <ol><li>[Review the headers]</li> <li>Infer data-types and review</li> <li>[Add constraints]</li> <li>Data validation (and correction?)</li></ol></li> <li><p>General metadata (if necessary)</p> <ol><li>Title, description</li> <li>License</li></ol></li> <li><p>Publish (atm: just download metadata (and cleaned data)</p></li></ol> <h4 id="_1-load"><a href="#_1-load" class="header-anchor">#</a> 1. Load</h4> <ol><li><p>User drops a file or uploads a file</p> <ul><li>What about a url? Secondary for now</li> <li>What about import from other sources e.g. google sheets, dropbox etc? KISS =&gt; leave for now</li> <li>Size restrictions? Let’s assume we’re ok</li> <li>Error reporting: any errors loading the data file should be reported …</li> <li>[Future]: in the background we’d be uploading this file to a file store while we do the rest of this process</li> <li>Tooling options: <a href="https://uppy.io/" target="_blank" rel="noopener noreferrer">https://uppy.io/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> (note does lots more!), roll out own, <a href="http://filepicker.io" target="_blank" rel="noopener noreferrer">filepicker.io<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> (proprietary =&gt; no), …
<ul><li>How do we find something that just does file selection and provides us with the object</li></ul></li> <li>[Final output] =&gt; a raw file object, raw file info (? or we already pass to data.js?)</li></ul></li> <li><p>Detect type / format (from file name …)</p></li></ol> <ul><li>Prompt user to confirm the guess (or proceed automatically if guessed)?</li> <li>Tooling: data.js already does this …</li></ul> <ol start="3"><li><p>Choose the data (e.g. sheets from excel)</p> <ul><li>Skip if CSV or if one sheet</li> <li>Multiple sheets:
<ul><li>Present preview of the sheets ?? (limit to first 10 if a lot of sheets)</li> <li>Option of choosing all sheets</li></ul></li></ul></li></ol> <h4 id="_2-structural-check-and-correction"><a href="#_2-structural-check-and-correction" class="header-anchor">#</a> 2. Structural check and correction</h4> <ol><li><p>Run a goodtables structure check on the data</p> <ul><li>=&gt; ability to load a sample of the data (not all of it if big)</li> <li>=&gt; goodtables js version</li></ul></li> <li><p>Preview the data and show structural errors</p></li> <li><p>[Optional / v2] Simple ETL in browser to correct this</p></li></ol> <h4 id="_3-table-metadata"><a href="#_3-table-metadata" class="header-anchor">#</a> 3. Table metadata</h4> <p>All done in a tabular like view if possible.</p> <p>Infer the types and present this in a view that allows review:</p> <ol><li>[Review the headers]</li> <li>Infer data-types and review</li> <li>[Add constraints] - optional and could leave out for now.</li></ol> <p>Then we do data validation against types (could do this live whilst they are editing …)</p> <ol start="4"><li>Data validation (and correction?)</li></ol> <h4 id="_4-general-metadata-if-necessary"><a href="#_4-general-metadata-if-necessary" class="header-anchor">#</a> 4. General metadata (if necessary)</h4> <p>Add the general metadata.</p> <ol><li>Title, description</li> <li>License</li></ol> <h4 id="_5-publish-atm-just-download-metadata-and-cleaned-data"><a href="#_5-publish-atm-just-download-metadata-and-cleaned-data" class="header-anchor">#</a> 5. Publish (atm: just download metadata (and cleaned data)</h4> <p>Show the dataresource.json and datapackage.json for now …</p> <h2 id="ckan-v2"><a href="#ckan-v2" class="header-anchor">#</a> CKAN v2</h2> <p>In CKAN 2 the data publishing flow is a integral part of core CKAN. See this section of the user guide for a walkhthrough: <a href="https://docs.ckan.org/en/2.9/user-guide.html#features-for-publishers" target="_blank" rel="noopener noreferrer">https://docs.ckan.org/en/2.9/user-guide.html#features-for-publishers<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Key points of note:</p> <ul><li>Classic python webapp approach using a combination of html templates (in Jinja) with processing code in Python backend code using controllers etc.</li> <li>Customization is done via client extensions using CKAN extensions model</li> <li>There is also a dedicated extension ckanext-scheming for creating froms from a JSON DSL.</li></ul> <h3 id="data-dictionary"><a href="#data-dictionary" class="header-anchor">#</a> Data Dictionary</h3> <p>Integrated with DataStore extension since CKAN v2.7. Old documentation with visuals at:</p> <p><a href="https://extensions.ckan.org/extension/dictionary/" target="_blank" rel="noopener noreferrer">https://extensions.ckan.org/extension/dictionary/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="issues"><a href="#issues" class="header-anchor">#</a> Issues</h3> <ul><li>Classic webapp is showing its age vs modern javascript based web application development. Nowadays, you’d usually build a UI like this in javascript and e.g. React or VueJS. This has implications for both:
<ul><li>UX: e.g. general lack of responsiveness, client side operations etc.</li> <li>Development: miss out on modern dev stack</li></ul></li> <li>No client-side direct to cloud upload etc</li> <li>Extension model has got complex and cumbersome: the template inheritance model is now somewhat byzantine to navigate. Changing data structures can operate at multiple levels.
<ul><li>The extension approach is “inheritance” based</li></ul></li> <li>ckanext-scheming uses its own DSL. Today, one would probably use JSON Schema and use a javascript framework.</li></ul> <p>In short, building a rich UI like this today would almost certainly be done in pure JS in something like React.</p> <h2 id="ckan-v3"><a href="#ckan-v3" class="header-anchor">#</a> CKAN v3</h2> <p>We recommend a pure JS React-based approach. The CKAN dataset and resource editor becomes a React app.</p> <p>We have developed a “DataPub(lishing)” framework that provides core components and template apps that you can use to get started building out a data publishing UI:</p> <p><a href="https://github.com/datopian/datapub/" target="_blank" rel="noopener noreferrer">https://github.com/datopian/datapub/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="design"><a href="#design" class="header-anchor">#</a> Design</h3> <p>See <a href="/publish/design/">Design page »</a></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/datopian/tech.datopian.com/edit/master/publish/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Modified:</span> <span class="time">2/4/2022, 5:37:35 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.63098cb8.js" defer></script><script src="/assets/js/3.d799bd9e.js" defer></script><script src="/assets/js/76.203d13f0.js" defer></script>
  </body>
</html>
