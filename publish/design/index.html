<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Publish - Design | Datopian Tech</title>
    <meta name="generator" content="VuePress 1.4.1">
    
    <meta name="description" content="An overview of our technology">
    <link rel="preload" href="/assets/css/0.styles.2870a88c.css" as="style"><link rel="preload" href="/assets/js/app.da5e338a.js" as="script"><link rel="preload" href="/assets/js/3.eb54c2a9.js" as="script"><link rel="preload" href="/assets/js/66.9e9bd6b1.js" as="script"><link rel="prefetch" href="/assets/js/10.ee3e1539.js"><link rel="prefetch" href="/assets/js/11.4ff3eed8.js"><link rel="prefetch" href="/assets/js/12.cbc3c053.js"><link rel="prefetch" href="/assets/js/13.29e33691.js"><link rel="prefetch" href="/assets/js/14.26f66382.js"><link rel="prefetch" href="/assets/js/15.9af6649e.js"><link rel="prefetch" href="/assets/js/16.a7996a2b.js"><link rel="prefetch" href="/assets/js/17.7195f5ce.js"><link rel="prefetch" href="/assets/js/18.7b7b654e.js"><link rel="prefetch" href="/assets/js/19.29a936c1.js"><link rel="prefetch" href="/assets/js/20.3beca913.js"><link rel="prefetch" href="/assets/js/21.83f66a6d.js"><link rel="prefetch" href="/assets/js/22.f2053f09.js"><link rel="prefetch" href="/assets/js/23.ecbe9400.js"><link rel="prefetch" href="/assets/js/24.397f8a1f.js"><link rel="prefetch" href="/assets/js/25.7842e248.js"><link rel="prefetch" href="/assets/js/26.f632647f.js"><link rel="prefetch" href="/assets/js/27.698acca2.js"><link rel="prefetch" href="/assets/js/28.4c772eae.js"><link rel="prefetch" href="/assets/js/29.0849bf82.js"><link rel="prefetch" href="/assets/js/30.33a03e24.js"><link rel="prefetch" href="/assets/js/31.f2b830dd.js"><link rel="prefetch" href="/assets/js/32.98d181a1.js"><link rel="prefetch" href="/assets/js/33.2a02ddf0.js"><link rel="prefetch" href="/assets/js/34.af810a7c.js"><link rel="prefetch" href="/assets/js/35.8c450ca5.js"><link rel="prefetch" href="/assets/js/36.ed930ebe.js"><link rel="prefetch" href="/assets/js/37.76d322b1.js"><link rel="prefetch" href="/assets/js/38.1cc7a3b8.js"><link rel="prefetch" href="/assets/js/39.9894f661.js"><link rel="prefetch" href="/assets/js/4.e0389801.js"><link rel="prefetch" href="/assets/js/40.f36e375c.js"><link rel="prefetch" href="/assets/js/41.397b3d23.js"><link rel="prefetch" href="/assets/js/42.4785b4fc.js"><link rel="prefetch" href="/assets/js/43.f9fd4950.js"><link rel="prefetch" href="/assets/js/44.f539a3a2.js"><link rel="prefetch" href="/assets/js/45.76ff6acf.js"><link rel="prefetch" href="/assets/js/46.409b8186.js"><link rel="prefetch" href="/assets/js/47.e98f5af6.js"><link rel="prefetch" href="/assets/js/48.bfb0637d.js"><link rel="prefetch" href="/assets/js/49.8252a315.js"><link rel="prefetch" href="/assets/js/5.511dbf42.js"><link rel="prefetch" href="/assets/js/50.6b0cceb2.js"><link rel="prefetch" href="/assets/js/51.c9154c0f.js"><link rel="prefetch" href="/assets/js/52.a0ff8fb8.js"><link rel="prefetch" href="/assets/js/53.6bf19214.js"><link rel="prefetch" href="/assets/js/54.5daf9e71.js"><link rel="prefetch" href="/assets/js/55.9b525305.js"><link rel="prefetch" href="/assets/js/56.0f286df4.js"><link rel="prefetch" href="/assets/js/57.cff6a480.js"><link rel="prefetch" href="/assets/js/58.122a1add.js"><link rel="prefetch" href="/assets/js/59.109ee6b4.js"><link rel="prefetch" href="/assets/js/6.5e64012e.js"><link rel="prefetch" href="/assets/js/60.b25a20ed.js"><link rel="prefetch" href="/assets/js/61.068b2383.js"><link rel="prefetch" href="/assets/js/62.f5d3711c.js"><link rel="prefetch" href="/assets/js/63.6b34aca8.js"><link rel="prefetch" href="/assets/js/64.ec57d1e4.js"><link rel="prefetch" href="/assets/js/65.ca9eceff.js"><link rel="prefetch" href="/assets/js/67.75b2bb76.js"><link rel="prefetch" href="/assets/js/68.bd487cb9.js"><link rel="prefetch" href="/assets/js/69.a4625d29.js"><link rel="prefetch" href="/assets/js/7.d6366f03.js"><link rel="prefetch" href="/assets/js/70.0fff76b4.js"><link rel="prefetch" href="/assets/js/71.bae1c571.js"><link rel="prefetch" href="/assets/js/72.b7951f8a.js"><link rel="prefetch" href="/assets/js/73.24d74dea.js"><link rel="prefetch" href="/assets/js/74.38053897.js"><link rel="prefetch" href="/assets/js/75.a0918dbc.js"><link rel="prefetch" href="/assets/js/76.8b1a8201.js"><link rel="prefetch" href="/assets/js/8.a6e2b590.js"><link rel="prefetch" href="/assets/js/9.8f4e7a57.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.edc363f1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2870a88c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Datopian Tech</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Features" class="dropdown-title"><span class="title">Features</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/views/" class="nav-link">
  Views
</a></li></ul></div></div> <a href="https://github.com/datopian/tech.datopian.com" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Features" class="dropdown-title"><span class="title">Features</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/views/" class="nav-link">
  Views
</a></li></ul></div></div> <a href="https://github.com/datopian/tech.datopian.com" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Publish - Design</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/publish/design/#introduction" class="sidebar-link">Introduction</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/publish/design/#the-framework-approach" class="sidebar-link">The framework approach</a></li></ul></li><li><a href="/publish/design/#design" class="sidebar-link">Design</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/publish/design/#principles-and-remarks" class="sidebar-link">Principles and Remarks</a></li><li class="sidebar-sub-header"><a href="/publish/design/#technology" class="sidebar-link">Technology</a></li><li class="sidebar-sub-header"><a href="/publish/design/#architecture" class="sidebar-link">Architecture</a></li></ul></li><li><a href="/publish/design/#key-flows" class="sidebar-link">Key Flows</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/publish/design/#components" class="sidebar-link">Components</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/publish/design/#plan-of-work" class="sidebar-link">Plan of Work</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/publish/design/#design-research" class="sidebar-link">Design Research</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/publish/design/#uploading-library" class="sidebar-link">Uploading library</a></li></ul></li><li><a href="/publish/design/#appendix-project-creation-flow-comparison" class="sidebar-link">Appendix: Project Creation Flow Comparison</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/publish/design/#github" class="sidebar-link">Github</a></li><li class="sidebar-sub-header"><a href="/publish/design/#gitlab" class="sidebar-link">Gitlab</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="publish-design"><a href="#publish-design" class="header-anchor">#</a> Publish - Design</h1> <h2 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h2> <p>Design of a DMS publishing system, with a focus on CKAN v3 / DataHub.</p> <p>Goal: an elegant single page application (that is easy to reuse and customize) that takes you from choosing your data file to a data package. Aka “a javascript app for turning a CSV into a data package”.</p> <p>This application would form the UI part of a “manual” user flow of importing a data file into a Data Portal.</p> <h3 id="the-framework-approach"><a href="#the-framework-approach" class="header-anchor">#</a> The framework approach</h3> <p>As a product, the Publish system should be thought of more as a framework than a single solution: a set of patterns, components and flows that can be composed together to build different applications and workflows.</p> <p>A given solution is created by composing together different components into an overall flow.</p> <p>This approach is is designed to be extensible so that new workflows and their requirements can be easily accommodated.</p> <h2 id="design"><a href="#design" class="header-anchor">#</a> Design</h2> <h3 id="principles-and-remarks"><a href="#principles-and-remarks" class="header-anchor">#</a> Principles and Remarks</h3> <ul><li>Simplicity: a focus on extraordinary, easy and elegant user experience</li> <li>Speed: not only responsiveness, but also speed to being “done”</li> <li>Tabular: focus on tabular data to start with</li> <li>Adaptable / Reusable: this system should be rapidly adaptable for other import flows
<ul><li>A copy-and-paste-able template that is then adapt with minor changes</li> <li>Over time this may evolve to something configurable</li></ul></li> <li>CKAN-compatible (?): (Longer term) e.g. be able to reuse ckanext-scheming config</li></ul> <h3 id="technology"><a href="#technology" class="header-anchor">#</a> Technology</h3> <ul><li>Build in Javascript as a SPA (single page application)</li> <li>Use React as the framework</li> <li>? Assume we can use NextJS as the SSR/SSG app</li> <li>Use Apollo local storage (rather than Redux) for state management</li></ul> <h3 id="architecture"><a href="#architecture" class="header-anchor">#</a> Architecture</h3> <ul><li>Encapsulate interaction with backend in a library. Backend is CKAN MetaStore and Blob Storage access, raw Blob Storage itself (almost certainly cloud)</li> <li>Split UI into clear components and even sub-applications (for example, a sub-application for resource adding)</li> <li>Use <a href="https://f11s.com/" target="_blank" rel="noopener noreferrer">Frictioness specs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for structuring storage of data objects such as Dataset, Resource, Table Schema etc will be in</li> <li>The specification of these formats themselves will be done in JSON schema and JSON Schema is what we use for specifying  new metadata profiles (usually extensions or customizations of the base Frictionless ones)</li> <li>Data schemas are described using Table Schema (for tabular data) or JSON Schema.</li></ul> <p>Diagram: SDK library encapsulates interaction with backend</p> <div class="spinner" style="background:rgb(66, 185, 131);" data-v-1bbcb91a></div><p>Working assumptions</p> <ul><li>Permissions is “outside” of the UI: we can assume that UI is only launched for people with relevant permissions and that permissions are ultimately enforced in the backend (i.e. if someone attempts to save a dataset they don’t have permission for that will fail in the call to the backend). =&gt; we don’t need to show/hide/restrict based on permissions.</li></ul> <h2 id="key-flows"><a href="#key-flows" class="header-anchor">#</a> Key Flows</h2> <ul><li><strong>Ultra-simple resource(s) publishing</strong>: Publish/share a resource (file) <em>fast</em> to a new project (and dataset) - ultra-simple version (like adding a file to Drive or DropBox)
<ul><li>Implicitly creates a project and dataset</li></ul></li> <li><strong>Publish resource(s) and make a dataset</strong> Publish a file and create the dataset explicitly (ie. add title, license etc)</li> <li><strong>Add resource(s) to a dataset</strong>: a new resource to an existing dataset
<ul><li>Add multiple resources at once</li></ul></li> <li>Edit the metadata of an existing dataset</li></ul> <p>Qu:</p> <ul><li>Do we even permit the super simple option - it’s attractive but it brings some complexity in the UI<br>
(either we need to make user provide project/dataset level metadata at end or we guess it for them and guessing usually goes wrong). Note that Github makes you create the “project” and its repo before you can push anything.</li></ul> <h2 id="components"><a href="#components" class="header-anchor">#</a> Components</h2> <p>UI</p> <ul><li>File uploader</li> <li>Resource</li></ul> <p>SDK</p> <ul><li>File upload</li> <li>MetaStore
<ul><li>(Project creation / updating)</li> <li>Dataset creation / updating</li></ul></li> <li>…</li></ul> <h2 id="plan-of-work"><a href="#plan-of-work" class="header-anchor">#</a> Plan of Work</h2> <p>Task brainstorm</p> <ul><li></li></ul> <div class="spinner" style="background:rgb(66, 185, 131);" data-v-1bbcb91a></div><h2 id="design-research"><a href="#design-research" class="header-anchor">#</a> Design Research</h2> <h3 id="uploading-library"><a href="#uploading-library" class="header-anchor">#</a> Uploading library</h3> <p>Atm we implement from “scratch”. Could we use an “off the shelf” solution e.g. uppy</p> <p>Impressions of uppy:</p> <ul><li>Good support</li> <li>Open-source MIT</li> <li>Beautiful design</li> <li>Customizable</li> <li>Support (dropbox, google drive, AWS S3, Tus, XHR)</li></ul> <p>Question:</p> <ul><li>how to implement uppy + CKAN SDK?</li> <li>support for azure <a href="https://github.com/transloadit/uppy/issues/1591" target="_blank" rel="noopener noreferrer">https://github.com/transloadit/uppy/issues/1591<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> (seems like it can work but maybe issue with large files (?))</li></ul> <h2 id="appendix-project-creation-flow-comparison"><a href="#appendix-project-creation-flow-comparison" class="header-anchor">#</a> Appendix: Project Creation Flow Comparison</h2> <h3 id="github"><a href="#github" class="header-anchor">#</a> Github</h3> <p>Step 1</p> <p><img src="https://i.imgur.com/J5logpK.png" alt=""></p> <p>Step 2</p> <p><img src="https://i.imgur.com/ruAQxCL.png" alt=""></p> <h3 id="gitlab"><a href="#gitlab" class="header-anchor">#</a> Gitlab</h3> <p>Step 1</p> <p><img src="https://i.imgur.com/jhtK4Ew.png" alt=""></p> <p>Step 2</p> <p><img src="https://i.imgur.com/me8uTRo.png" alt=""></p> <p><img src="https://i.imgur.com/8HjRRFR.png" alt=""></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/datopian/tech.datopian.com/edit/master/publish/design/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Modified:</span> <span class="time">9/3/2020, 6:09:48 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.da5e338a.js" defer></script><script src="/assets/js/3.eb54c2a9.js" defer></script><script src="/assets/js/66.9e9bd6b1.js" defer></script>
  </body>
</html>
