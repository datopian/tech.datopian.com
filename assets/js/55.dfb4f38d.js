(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{418:function(e,t,a){"use strict";a.r(t);var s=a(18),r=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"frontend-plugins"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#frontend-plugins"}},[e._v("#")]),e._v(" Frontend plugins")]),e._v(" "),a("p",[e._v("Plugins allow you to extend the functionality of the Frontend in all important ways:")]),e._v(" "),a("ul",[a("li",[e._v("Adding new pages (or overriding existing ones)")]),e._v(" "),a("li",[e._v("Add or adjust authentication and authorization")]),e._v(" "),a("li",[e._v("Add functionality to every page e.g. add analytics")]),e._v(" "),a("li",[e._v("Overriding or adding data sources")])]),e._v(" "),a("h2",{attrs:{id:"introduction"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#introduction"}},[e._v("#")]),e._v(" Introduction")]),e._v(" "),a("p",[e._v("Plugins are extremely easy. Remember the Next Gen frontend is just an express app.")]),e._v(" "),a("p",[e._v("Plugins are therefore just vanilla Express!")]),e._v(" "),a("p",[e._v("Plugin files are passed the Express "),a("code",[e._v("app")]),e._v(" object which they can then extend with middleware or routes. If you aren’t familiar with Express or Express middleware, you may  want to get up to speed: "),a("a",{attrs:{href:"https://expressjs.com/en/guide/writing-middleware.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://expressjs.com/en/guide/writing-middleware.html"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("There are currently two types of plugins: “local” plugins which are added to the "),a("code",[e._v("/plugins")]),e._v(" directory, and npm plugins, which we install via npm.")]),e._v(" "),a("p",[e._v("There are also a variety of built-in plugins that come with the default system.")]),e._v(" "),a("h2",{attrs:{id:"local-plugins"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#local-plugins"}},[e._v("#")]),e._v(" Local Plugins")]),e._v(" "),a("p",[e._v("Create a directory with the plugin’s name in the "),a("code",[e._v("/plugins")]),e._v(" directory.")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("mkdir")]),e._v(" plugins/addheader\n")])])]),a("p",[e._v("Inside of this directory create a file called "),a("code",[e._v("index.js")]),e._v(" with the following contents:")]),e._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[e._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[e._v("exports")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[e._v("app")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[e._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=>")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("header")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'x-my-custom-header'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1234")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),a("p",[e._v("If you have worked with express middleware, you may recognize this pattern. For more on working with middleware in Express, see the docs "),a("a",{attrs:{href:"https://expressjs.com/en/guide/writing-middleware.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("p",[e._v("Add the plugin name to your "),a("code",[e._v(".env")]),e._v(" file:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('PLUGINS="addheader"\n')])])]),a("p",[e._v("Run your application. Web responses from the frontend application should include your custom header.")]),e._v(" "),a("h2",{attrs:{id:"npm-plugins"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#npm-plugins"}},[e._v("#")]),e._v(" NPM Plugins")]),e._v(" "),a("p",[e._v("If an express middleware plugin is available as a standalone module on npm you can install it as-is by installing the package via npm, and adding it to your PLUGINS variable in "),a("code",[e._v(".env")])]),e._v(" "),a("p",[e._v("For example, we will install the cookie-parser plugin, alongside our addheader plugin.")]),e._v(" "),a("p",[e._v("Install the npm package:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ yarn add cookie-parser\n")])])]),a("p",[e._v("Now add the plugins to your "),a("code",[e._v(".env")]),e._v(", alongside the custom "),a("code",[e._v("addheader")]),e._v(" plugin we created above:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('PLUGINS="addheader cookie-parser"\n')])])]),a("p",[e._v("Cookie-parser will now be applied to all of your requests as express middleware!")]),e._v(" "),a("p",[e._v("(For instance, you could take advantage of this in custom routes, etc)")]),e._v(" "),a("p",[e._v("For more on express middleware: "),a("a",{attrs:{href:"https://expressjs.com/en/guide/using-middleware.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://expressjs.com/en/guide/using-middleware.html"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("h2",{attrs:{id:"built-in-plugins"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#built-in-plugins"}},[e._v("#")]),e._v(" Built-in Plugins")]),e._v(" "),a("p",[e._v("There are a variety of built-in plugins that provide common functionality “out of the box”. For example, most of the projects need a CMS solution (most commonly WordPress or CKAN Pages) or analytics system such as Google Analytics. So we’ve developed number of built-in plugins that you can use in your project and deliver features easily and reliably.")]),e._v(" "),a("p",[e._v("All built-in plugins are located here - "),a("a",{attrs:{href:"https://github.com/datopian/frontend-v2/tree/master/plugins",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/datopian/frontend-v2/tree/master/plugins"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("p",[e._v("We constantly add something new but here is the list of currently available plugins:")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("applications-showcase")]),e._v(" - integration of "),a("a",{attrs:{href:"https://github.com/ckan/ckanext-showcase",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/ckan/ckanext-showcase"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("li",[a("code",[e._v("carto")]),e._v(" - provides carto map visualizations via the Carto VL library.")]),e._v(" "),a("li",[a("code",[e._v("ckan_pages")]),e._v(" - integration of "),a("a",{attrs:{href:"https://github.com/ckan/ckanext-pages",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/ckan/ckanext-pages"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("li",[a("code",[e._v("dashboard")]),e._v(" - dashboards based on "),a("a",{attrs:{href:"https://github.com/datopian/dashboard-js/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/datopian/dashboard-js/"),a("OutboundLink")],1),e._v(" library.")]),e._v(" "),a("li",[a("code",[e._v("google-analytics")]),e._v(" - Google Analytics integration.")]),e._v(" "),a("li",[a("code",[e._v("mailer")]),e._v(" - SMTP server in your frontend app.")]),e._v(" "),a("li",[a("code",[e._v("proxy")]),e._v(" - a proxy for your frontend app.")]),e._v(" "),a("li",[a("code",[e._v("wp")]),e._v(" - WordPress CMS integration plugin.")]),e._v(" "),a("li",[a("code",[e._v("disqus")]),e._v(" - Disqus integration.")])]),e._v(" "),a("h2",{attrs:{id:"how-do-i-enable-them"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-do-i-enable-them"}},[e._v("#")]),e._v(" How do I enable them?")]),e._v(" "),a("p",[e._v("Simply add a name of a plugin into your list of "),a("code",[e._v("PLUGINS")]),e._v(" in your "),a("RouterLink",{attrs:{to:"/frontend/configs/"}},[e._v("config file")]),e._v(":")],1),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("PLUGINS=proxy wp etc\n")])])]),a("h2",{attrs:{id:"how-do-i-use-them"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-do-i-use-them"}},[e._v("#")]),e._v(" How do I use them?")]),e._v(" "),a("h3",{attrs:{id:"applications-showcase"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#applications-showcase"}},[e._v("#")]),e._v(" Applications showcase")]),e._v(" "),a("p",[e._v("To add applications showcase plugin to your application you need to"),a("br"),e._v("\nenable the plugin in your "),a("code",[e._v(".env")]),e._v(" file:")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("PLUGINS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"... applications-showcase ..."')]),e._v("\n")])])]),a("p",[e._v("Here is the list of well-known services that can be used without setting host and port of your SMTP server: "),a("a",{attrs:{href:"https://nodemailer.com/smtp/well-known/#supported-services",target:"_blank",rel:"noopener noreferrer"}},[e._v("Supported services"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("p",[e._v("Then you need to implement "),a("code",[e._v("contact.html")]),e._v(" template in your theme so that a contact form can be rendered at "),a("code",[e._v("/contact")]),e._v(".")]),e._v(" "),a("h3",{attrs:{id:"carto"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#carto"}},[e._v("#")]),e._v(" Carto")]),e._v(" "),a("p",[e._v("Provide carto map visualizations via the Carto VL library.")]),e._v(" "),a("p",[e._v("Assumes data is in carto.")]),e._v(" "),a("h4",{attrs:{id:"geocoding-data"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#geocoding-data"}},[e._v("#")]),e._v(" Geocoding data")]),e._v(" "),a("p",[e._v("Data needs to have a "),a("code",[e._v("the_geom")]),e._v(" column with a valid geometry object.")]),e._v(" "),a("p",[e._v("See:")]),e._v(" "),a("p",[a("a",{attrs:{href:"https://carto.com/developers/data-services-api/reference/#geocoding-functions",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://carto.com/developers/data-services-api/reference/#geocoding-functions"),a("OutboundLink")],1)]),e._v(" "),a("p",[a("a",{attrs:{href:"https://carto.com/help/working-with-data/carto-functions/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://carto.com/help/working-with-data/carto-functions/"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("SELECT CDB_LatLng(float, float)")]),e._v(" "),a("p",[e._v("To encode from lat long:")]),e._v(" "),a("p",[e._v("https://{USER_NAME}.carto.com/api/v2/sql?q=UPDATE {TABLE_NAME} SET the_geom = CDB_LatLng({LAT_COLUMN}, {LON_COLUMN})&api_key={API_KEY_WITH_WRITE_ACCESS}")]),e._v(" "),a("p",[a("a",{attrs:{href:"https://paulwalker-datopian.carto.com/api/v2/sql?q=UPDATE",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://paulwalker-datopian.carto.com/api/v2/sql?q=UPDATE"),a("OutboundLink")],1),e._v(" accidents_2012_2017 SET the_geom = CDB_LatLng(loc_lat, loc_long)&api_key=Mef_QoqGyQRspq9AumGvbg")]),e._v(" "),a("p",[e._v("Auth: Note that the token used needs to be associated with an API user with write / update permissions")]),e._v(" "),a("h3",{attrs:{id:"ckan-pages"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ckan-pages"}},[e._v("#")]),e._v(" CKAN Pages")]),e._v(" "),a("p",[e._v("To use CKAN Pages as your CMS backend, add it to your list of "),a("code",[e._v("PLUGINS")]),e._v(" in "),a("code",[e._v(".env")]),e._v(" file:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("PLUGINS=ckan_pages\n")])])]),a("p",[e._v("When enabled, CKAN Pages plugin will use the CKAN "),a("code",[e._v("API_URL")]),e._v(" environment variable by default."),a("br"),e._v("\nTo configure a different URL for your CKAN Pages backend add "),a("code",[e._v("CKAN_PAGES_URL=https://yourckan.com/api/3/action/")]),e._v(" to your environment.")]),e._v(" "),a("p",[e._v("For more info about enabling and using CKAN Pages - "),a("a",{attrs:{href:"https://github.com/ckan/ckanext-pages",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/ckan/ckanext-pages"),a("OutboundLink")],1)]),e._v(" "),a("h3",{attrs:{id:"dashboard"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dashboard"}},[e._v("#")]),e._v(" Dashboard")]),e._v(" "),a("p",[e._v("Integration of "),a("a",{attrs:{href:"https://github.com/datopian/dashboard-js/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/datopian/dashboard-js/"),a("OutboundLink")],1),e._v(" library. Dashboard configurations are fetched from a git repository. You need to set it up via your config file:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("GIT_BASE_URL=\nGIT_OWNER=\n")])])]),a("p",[e._v("We’ve created a tutorial about how to create and use dashboards:")]),e._v(" "),a("p",[a("a",{attrs:{href:"http://tech.datopian.com/dashboards/",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://tech.datopian.com/dashboards/"),a("OutboundLink")],1)]),e._v(" "),a("h3",{attrs:{id:"google-analytics"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#google-analytics"}},[e._v("#")]),e._v(" Google analytics")]),e._v(" "),a("p",[e._v("To add Google Analytics enable the plugin in your "),a("code",[e._v(".env")]),e._v(" file:")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("PLUGINS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"... google-analytics ..."')]),e._v("\n")])])]),a("h4",{attrs:{id:"tracking-code"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tracking-code"}},[e._v("#")]),e._v(" Tracking code")]),e._v(" "),a("p",[e._v("To add tracking code to page templates, set up "),a("code",[e._v("GA_ID")]),e._v(" env variable:")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("GA_ID")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("UA-000000000-0\n")])])]),a("h4",{attrs:{id:"google-analytics-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#google-analytics-api"}},[e._v("#")]),e._v(" Google Analytics Api")]),e._v(" "),a("p",[e._v("To set up "),a("a",{attrs:{href:"https://developers.google.com/analytics/devguides/reporting/core/v3/reference",target:"_blank",rel:"noopener noreferrer"}},[e._v("google analytics API"),a("OutboundLink")],1),e._v(":")]),e._v(" "),a("ol",[a("li",[e._v("create "),a("a",{attrs:{href:"https://developers.google.com/analytics/devguides/reporting/core/v3/quickstart/service-py#clientId",target:"_blank",rel:"noopener noreferrer"}},[e._v("Service Account credentials in google developer console"),a("OutboundLink")],1)]),e._v(" "),a("li",[e._v("use the credentials from the json file for the following env variables:")])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("GA_CLIENT_EMAIL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("client_email"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("GA_PRIVATE_KEY")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("private_key, a long string with line breaks, should be inside inside quotes "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v('"'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])])]),a("ol",{attrs:{start:"3"}},[a("li",[e._v("find the view id in google analytics,")])]),e._v(" "),a("ul",[a("li",[e._v("you can specify it in the env file:")])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("GA_VIEW_ID")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("optional, can be specified "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("in")]),e._v(" request params"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])])]),a("ul",[a("li",[e._v("or specify it directly in the code later, in case you’ll need different views")])]),e._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[e._v("example of the google analytics api object use:")])]),e._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("...")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" view_id "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("view id "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("from")]),e._v(" google analytics"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" gaApi "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'ga-api'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" params "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'ids'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'ga:'")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("+")]),e._v(" view_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("//optionally here or in env file")]),e._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'start-date'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'30daysAgo'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'end-date'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'today'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'sort'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'-ga:uniquePageviews'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'dimensions'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'ga:pagePathLevel2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'metrics'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'ga:uniquePageviews'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'max-results'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("30")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'filters'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'ga:pagePathLevel1==/dataset/'")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" googleAnalyticsData "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" gaApi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("...")]),e._v("\n")])])]),a("h3",{attrs:{id:"mailer"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mailer"}},[e._v("#")]),e._v(" Mailer")]),e._v(" "),a("p",[e._v("To enable mailer plugin, you need to update your "),a("code",[e._v(".env")]),e._v(" as following:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("PLUGINS=\"... mailer ...\"\nSMTP_SERVICE=gmail (optional if you have host and port details)\nSMTP_HOST=smtp.example.com (optional if you set 'SMTP_SERVICE')\nSMTP_PORT=587 (optional if you set 'SMTP_SERVICE')\nEMAIL_FROM=from@example.com\nEMAIL_PASSWORD=*****\nEMAIL_TO=to@example.com\n")])])]),a("h3",{attrs:{id:"proxy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#proxy"}},[e._v("#")]),e._v(" Proxy")]),e._v(" "),a("p",[e._v("The proxy plugin ships with frontend-v2. To enable it via "),a("code",[e._v(".env")]),e._v(" file:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("PLUGINS=proxy other_plugins\n")])])]),a("p",[e._v("Use "),a("code",[e._v("PROXY_DATASTORE")]),e._v(" and "),a("code",[e._v("PROXY_FILESTORE")]),e._v(" environment variables to indicate host of your datastore and filestore:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("PROXY_DATASTORE=demo.ckan.org\nPROXY_FILESTORE=\n")])])]),a("p",[e._v("Now you can request datastore by "),a("code",[e._v("/proxy/datastore/{path}")]),e._v(".")]),e._v(" "),a("h3",{attrs:{id:"wp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#wp"}},[e._v("#")]),e._v(" WP")]),e._v(" "),a("h4",{attrs:{id:"setup"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#setup"}},[e._v("#")]),e._v(" Setup")]),e._v(" "),a("p",[e._v("The wordpress plugin ("),a("code",[e._v("/plugins/wp")]),e._v(") ships with frontend-v2. To enable it via "),a("code",[e._v(".env")]),e._v(" file:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("PLUGINS=wp\n")])])]),a("p",[e._v("Use "),a("code",[e._v("WP_URL")]),e._v(" environment variable to point to your WordPress instance. For example, we have test wordpress blog here "),a("a",{attrs:{href:"https://oddk.home.blog/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://oddk.home.blog/"),a("OutboundLink")],1),e._v(" so it would be:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("WP_URL=https://oddk.home.blog/\n")])])]),a("p",[e._v("Use "),a("code",[e._v("WP_BLOG_PATH")]),e._v(" environment variable to configure where your blog should be located in your site - by default, it is at "),a("code",[e._v("/news")]),e._v(". To change it, e.g., to "),a("code",[e._v("/blog")]),e._v(":")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('WP_BLOG_PATH="/blog"\n')])])]),a("p",[e._v("If your blog is private, you can set up "),a("code",[e._v("WP_TOKEN")]),e._v(" environment variable to pass your access token. To get access token for private WP blog, check out this - "),a("a",{attrs:{href:"https://developer.wordpress.com/docs/oauth2/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://developer.wordpress.com/docs/oauth2/"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("h4",{attrs:{id:"how-it-works"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-it-works"}},[e._v("#")]),e._v(" How it works")]),e._v(" "),a("p",[e._v("The plugin adds/changes the following routes:")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("/")]),e._v(" - your home view now receives "),a("code",[e._v("posts")]),e._v(" variable with the latest 3 blog posts from your WP instance;")]),e._v(" "),a("li",[a("code",[e._v("/news")]),e._v(" - your blog view now receives "),a("code",[e._v("posts")]),e._v(" variable with the latest 10 blog posts;")]),e._v(" "),a("li",[a("code",[e._v("/news/:page")]),e._v(" - renders individual post page - "),a("code",[e._v("post.html")]),e._v(" view;")]),e._v(" "),a("li",[a("code",[e._v("/:page")]),e._v(" and "),a("code",[e._v("/:parent/:page")]),e._v(" - if slug is found in your WP instance, renders static page view ("),a("code",[e._v("static.html")]),e._v(").")])]),e._v(" "),a("h3",{attrs:{id:"disqus"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#disqus"}},[e._v("#")]),e._v(" Disqus")]),e._v(" "),a("p",[e._v("We don’t have special plugin for this feature as you can simply setup an account on "),a("a",{attrs:{href:"https://disqus.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://disqus.com/"),a("OutboundLink")],1),e._v(" and get a snippet that you can paste in your template. E.g., you can paste it in the "),a("code",[e._v("showcase.html")]),e._v(" if you need it for every dataset page and so on.")]),e._v(" "),a("h2",{attrs:{id:"where-should-i-look-for-source-code-of-these-plugins"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#where-should-i-look-for-source-code-of-these-plugins"}},[e._v("#")]),e._v(" Where should I look for source code of these plugins?")]),e._v(" "),a("p",[e._v("You can find all plugins here - "),a("a",{attrs:{href:"https://github.com/datopian/frontend-v2/tree/master/plugins",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/datopian/frontend-v2/tree/master/plugins"),a("OutboundLink")],1),e._v(".")])])}),[],!1,null,null,null);t.default=r.exports}}]);